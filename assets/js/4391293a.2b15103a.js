"use strict";(self.webpackChunkq_01_docs=self.webpackChunkq_01_docs||[]).push([[4396],{6416:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>t,metadata:()=>a,toc:()=>l});var r=s(7624),o=s(2172);const t={title:"Command Operations",sidebar_label:"Command Operations",sidebar_position:7,description:"Special operations for business logic, exports, and system maintenance"},i="Command Operations",a={id:"products/map.q01.io/core-api-platform-v4/api-operations/command-operations",title:"Command Operations",description:"Special operations for business logic, exports, and system maintenance",source:"@site/docs/products/map.q01.io/core-api-platform-v4/02-api-operations/command-operations.md",sourceDirName:"products/map.q01.io/core-api-platform-v4/02-api-operations",slug:"/products/map.q01.io/core-api-platform-v4/api-operations/command-operations",permalink:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/command-operations",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:7,frontMatter:{title:"Command Operations",sidebar_label:"Command Operations",sidebar_position:7,description:"Special operations for business logic, exports, and system maintenance"},sidebar:"mapSidebar",previous:{title:"Sort Operations",permalink:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/sort-operations"},next:{title:"Batch Operations",permalink:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/batch-operations"}},c={},l=[{value:"Overview",id:"overview",level:2},{value:"Command Types",id:"command-types",level:2},{value:"1. Export Operations",id:"1-export-operations",level:3},{value:"2. System Maintenance",id:"2-system-maintenance",level:3},{value:"3. Custom Business Logic",id:"3-custom-business-logic",level:3},{value:"Export Operations",id:"export-operations",level:2},{value:"Trigger Export",id:"trigger-export",level:3},{value:"Check Export Status",id:"check-export-status",level:3},{value:"JavaScript Export Client",id:"javascript-export-client",level:3},{value:"System Maintenance Commands",id:"system-maintenance-commands",level:2},{value:"Clean Expired Sessions",id:"clean-expired-sessions",level:3},{value:"Implementation Details",id:"implementation-details",level:3},{value:"Custom Command Pattern",id:"custom-command-pattern",level:2},{value:"Creating Custom Commands",id:"creating-custom-commands",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"\u2705 DO",id:"-do",level:3},{value:"\u274c DON&#39;T",id:"-dont",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Export Errors",id:"export-errors",level:3},{value:"Command Errors",id:"command-errors",level:3},{value:"Use Case: Product Catalog Export",id:"use-case-product-catalog-export",level:2},{value:"Summary",id:"summary",level:2},{value:"Related Concepts",id:"related-concepts",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"command-operations",children:"Command Operations"}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Command operations"})," execute special business logic that doesn't fit the standard CRUD pattern. These include data exports, system maintenance tasks, background processing, and custom workflows."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Characteristics:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Special-purpose operations beyond CRUD"}),"\n",(0,r.jsx)(n.li,{children:"Can be long-running or background processes"}),"\n",(0,r.jsx)(n.li,{children:"Execute Symfony Console Commands via HTTP API"}),"\n",(0,r.jsx)(n.li,{children:"Include export, import, maintenance, and custom logic"}),"\n",(0,r.jsx)(n.li,{children:"Often asynchronous with status endpoints"}),"\n",(0,r.jsx)(n.li,{children:"Return structured logs and execution results"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"command-types",children:"Command Types"}),"\n",(0,r.jsx)(n.h3,{id:"1-export-operations",children:"1. Export Operations"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"})," Generate data exports (CSV, Excel, PDF) from dimensions"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Endpoints:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /api/v4/export/{dim}"})," - Trigger export"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET /api/v4/export/status/{resourceId}"})," - Check export status"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Product catalog export"}),"\n",(0,r.jsx)(n.li,{children:"Customer data export"}),"\n",(0,r.jsx)(n.li,{children:"Order history reports"}),"\n",(0,r.jsx)(n.li,{children:"Bulk data extraction"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-system-maintenance",children:"2. System Maintenance"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"})," Perform system cleanup and maintenance tasks"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /api/v4/core/command/{commandName}"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"cleanExpiredSessions"})," - Remove expired JWT sessions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"cleanupExportFiles"})," - Delete old export files"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"cleanupPrintFiles"})," - Delete old print jobs"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-custom-business-logic",children:"3. Custom Business Logic"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"})," Execute dimension-specific or tenant-specific workflows"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /api/v4/core/command/{commandName}"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Data transformations"}),"\n",(0,r.jsx)(n.li,{children:"Batch calculations"}),"\n",(0,r.jsx)(n.li,{children:"External system integrations"}),"\n",(0,r.jsx)(n.li,{children:"Complex validations"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"export-operations",children:"Export Operations"}),"\n",(0,r.jsx)(n.h3,{id:"trigger-export",children:"Trigger Export"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"GET /api/v4/export/{dim}"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Required"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"dim"})}),(0,r.jsx)(n.td,{children:"path"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"Dimension code (PRD, CLI, ORD)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"source"})}),(0,r.jsx)(n.td,{children:"query"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"Security area"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"$filter"})}),(0,r.jsx)(n.td,{children:"query"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"Filter exported records"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"$select"})}),(0,r.jsx)(n.td,{children:"query"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"Select specific fields"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"$order"})}),(0,r.jsx)(n.td,{children:"query"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"Sort export data"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X GET "https://coreservice.q01.io/api/v4/export/PRD?source=productExport&\\$filter=XPRD06 eq true&\\$order=XPRD01 ASC" \\\n  -H "Authorization: Bearer eyJhbGc..."\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "resourceId": "exp_20251219_abc123",\n  "status": "processing",\n  "createdAt": "2025-12-19T14:30:00Z",\n  "estimatedCompletion": "2025-12-19T14:31:00Z"\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"resourceId:"})," Unique identifier for tracking export status"]}),"\n",(0,r.jsx)(n.h3,{id:"check-export-status",children:"Check Export Status"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"GET /api/v4/export/status/{resourceId}"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X GET "https://coreservice.q01.io/api/v4/export/status/exp_20251219_abc123" \\\n  -H "Authorization: Bearer eyJhbGc..."\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response (Processing):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "resourceId": "exp_20251219_abc123",\n  "status": "processing",\n  "progress": 45,\n  "totalRecords": 10000,\n  "processedRecords": 4500,\n  "createdAt": "2025-12-19T14:30:00Z"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response (Completed):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "resourceId": "exp_20251219_abc123",\n  "status": "completed",\n  "downloadUrl": "https://storage.googleapis.com/q01-exports/tenant123/export_PRD_20251219.csv",\n  "fileSize": 2048576,\n  "recordCount": 10000,\n  "completedAt": "2025-12-19T14:31:15Z",\n  "expiresAt": "2025-12-20T14:31:15Z"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response (Failed):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "resourceId": "exp_20251219_abc123",\n  "status": "failed",\n  "error": "Export failed: Database connection timeout",\n  "failedAt": "2025-12-19T14:30:45Z"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"javascript-export-client",children:"JavaScript Export Client"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"class ExportManager {\n  constructor(apiBase, token) {\n    this.apiBase = apiBase;\n    this.token = token;\n    this.pollInterval = 2000; // 2 seconds\n  }\n\n  async triggerExport(dimension, filters = {}) {\n    const url = new URL(`${this.apiBase}/api/v4/export/${dimension}`);\n    url.searchParams.append('source', filters.source || 'export');\n\n    if (filters.$filter) {\n      url.searchParams.append('$filter', filters.$filter);\n    }\n    if (filters.$select) {\n      url.searchParams.append('$select', filters.$select);\n    }\n    if (filters.$order) {\n      url.searchParams.append('$order', filters.$order);\n    }\n\n    const response = await fetch(url, {\n      headers: { 'Authorization': `Bearer ${this.token}` }\n    });\n\n    if (!response.ok) {\n      throw new Error('Export trigger failed');\n    }\n\n    const result = await response.json();\n    return result.resourceId;\n  }\n\n  async getExportStatus(resourceId) {\n    const response = await fetch(\n      `${this.apiBase}/api/v4/export/status/${resourceId}`,\n      {\n        headers: { 'Authorization': `Bearer ${this.token}` }\n      }\n    );\n\n    if (!response.ok) {\n      throw new Error('Status check failed');\n    }\n\n    return response.json();\n  }\n\n  async pollExport(resourceId, onProgress) {\n    return new Promise((resolve, reject) => {\n      const poll = async () => {\n        try {\n          const status = await this.getExportStatus(resourceId);\n\n          if (onProgress) {\n            onProgress(status);\n          }\n\n          if (status.status === 'completed') {\n            resolve(status);\n          } else if (status.status === 'failed') {\n            reject(new Error(status.error));\n          } else {\n            setTimeout(poll, this.pollInterval);\n          }\n        } catch (error) {\n          reject(error);\n        }\n      };\n\n      poll();\n    });\n  }\n\n  async exportAndDownload(dimension, filters = {}) {\n    // Trigger export\n    const resourceId = await this.triggerExport(dimension, filters);\n\n    // Poll until complete\n    const result = await this.pollExport(resourceId, (status) => {\n      console.log(`Export progress: ${status.progress || 0}%`);\n    });\n\n    // Download file\n    window.location.href = result.downloadUrl;\n\n    return result;\n  }\n}\n\n// Usage\nconst exporter = new ExportManager(apiBase, token);\n\nasync function exportProducts() {\n  try {\n    const result = await exporter.exportAndDownload('PRD', {\n      source: 'productExport',\n      $filter: 'XPRD06 eq true',\n      $order: 'XPRD01 ASC'\n    });\n\n    console.log(`Export completed: ${result.recordCount} records`);\n  } catch (error) {\n    console.error('Export failed:', error);\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"system-maintenance-commands",children:"System Maintenance Commands"}),"\n",(0,r.jsx)(n.h3,{id:"clean-expired-sessions",children:"Clean Expired Sessions"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint:"})," ",(0,r.jsx)(n.code,{children:"POST /api/v4/core/command/cleanExpiredSessions"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"})," Remove expired JWT sessions from TB_ANAG_SESSIONS00"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Authentication:"})," Required (admin privileges)"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:'POST /api/v4/core/command/cleanExpiredSessions\nContent-Type: application/json\nAuthorization: Bearer {token}\n\n{\n  "source": "systemMaintenance"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": 200,\n  "log": "cleanExpiredSessions successfully executed",\n  "full_message": "CoreApi Expired Sessions Cleanup\\n[OK] 15 expired sessions deleted from server!\\n[NOTE] There are currently 42 active sessions"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"How It Works:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Fetches all sessions from TB_ANAG_SESSIONS00 where TREC != 'P'"}),"\n",(0,r.jsxs)(n.li,{children:["Calculates max life: ",(0,r.jsx)(n.code,{children:"XSESSIONS05 + JWT_INACTIVITY"})]}),"\n",(0,r.jsxs)(n.li,{children:["Deletes sessions where ",(0,r.jsx)(n.code,{children:"maxLife < now"})]}),"\n",(0,r.jsx)(n.li,{children:"Returns count of deleted and active sessions"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Environment Variables:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"JWT_INACTIVITY"}),": Session inactivity timeout (seconds)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"CoreCommandController.php:32-66"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:'public function executeCommand(Request $request, KernelInterface $kernel)\n{\n    $commandName = $routeArgs[\'commandName\'];\n    $data_form = json_decode($request->getContent(), true);\n\n    // Build command name with optional package prefix\n    $cmdPkg = isset($data_form[\'cmdPkg\']) ? $data_form[\'cmdPkg\'] . ":" : "";\n    $data_form[\'command\'] = $cmdPkg . $commandName;\n\n    // Execute Symfony Console Command via HTTP\n    $application = new Application($kernel);\n    $application->setAutoExit(false);\n\n    $input = new ArrayInput($data_form);\n    $output = new BufferedOutput();\n    $returnCode = $application->run($input, $output);\n\n    // Return command output\n    $content = $output->fetch();\n\n    return json([\n        "status" => 200,\n        "log" => "$commandName successfully executed",\n        "full_message" => rtrim($content)\n    ]);\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"custom-command-pattern",children:"Custom Command Pattern"}),"\n",(0,r.jsx)(n.h3,{id:"creating-custom-commands",children:"Creating Custom Commands"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Define Symfony Console Command:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:'<?php\nnamespace App\\Command\\Custom;\n\nuse Symfony\\Component\\Console\\Command\\Command;\nuse Symfony\\Component\\Console\\Input\\InputInterface;\nuse Symfony\\Component\\Console\\Output\\OutputInterface;\n\nclass MyCustomCommand extends Command\n{\n    protected $commandName = "myPkg:myCustomCommand";\n    protected $commandDescription = "Execute custom business logic";\n\n    protected function configure()\n    {\n        $this\n            ->setName($this->commandName)\n            ->setDescription($this->commandDescription);\n    }\n\n    protected function execute(InputInterface $input, OutputInterface $output)\n    {\n        // Custom logic here\n        $output->writeln("Executing custom command...");\n\n        // Return status code\n        return Command::SUCCESS;\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Register Command:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# config/services.yaml\nservices:\n    App\\Command\\Custom\\MyCustomCommand:\n        tags:\n            - { name: 'console.command' }\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Expose via HTTP:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:'POST /api/v4/core/command/myCustomCommand\nContent-Type: application/json\nAuthorization: Bearer {token}\n\n{\n  "cmdPkg": "myPkg",\n  "source": "customOperation"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": 200,\n  "log": "myCustomCommand successfully executed",\n  "full_message": "Executing custom command...\\nCompleted successfully."\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"-do",children:"\u2705 DO"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use polling for long-running exports:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const result = await exporter.pollExport(resourceId, (status) => {\n  updateProgressBar(status.progress);\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Set reasonable poll intervals:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 Good - 2-5 seconds\nthis.pollInterval = 2000;\n\n// \u274c Bad - too frequent\nthis.pollInterval = 100;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Handle export expiry:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const status = await exporter.getExportStatus(resourceId);\nif (status.expiresAt < new Date()) {\n  // Re-trigger export\n  resourceId = await exporter.triggerExport(dimension, filters);\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Provide user feedback:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"await exporter.pollExport(resourceId, (status) => {\n  showNotification(`Processing: ${status.processedRecords}/${status.totalRecords}`);\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"-dont",children:"\u274c DON'T"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't poll completed exports:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Wrong - wastes resources\nsetInterval(() => checkStatus(resourceId), 2000);\n\n// \u2705 Correct - stop polling when complete\nif (status.status === 'completed') {\n  clearInterval(pollTimer);\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't ignore export failures:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Wrong - silent failure\nconst status = await getExportStatus(resourceId);\n\n// \u2705 Correct - handle errors\nif (status.status === 'failed') {\n  showError(status.error);\n  logError('Export failed', { resourceId, error: status.error });\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't trigger duplicate exports:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Wrong - multiple concurrent exports\nonClick={() => triggerExport());\n\n// \u2705 Correct - prevent duplicates\nif (!this.exportInProgress) {\n  this.exportInProgress = true;\n  await triggerExport();\n  this.exportInProgress = false;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.h3,{id:"export-errors",children:"Export Errors"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Timeout:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "resourceId": "exp_20251219_abc123",\n  "status": "failed",\n  "error": "Export timeout: Processing exceeded 5 minutes",\n  "failedAt": "2025-12-19T14:35:00Z"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Permission Denied:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "code": 403,\n  "message": "Insufficient permissions for export operation",\n  "required_grant": 3\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Invalid Filters:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "code": 400,\n  "message": "Invalid $filter syntax",\n  "errors": [\n    {\n      "field": "$filter",\n      "message": "Unexpected token \'XPRD_INVALID\'"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"command-errors",children:"Command Errors"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Command Not Found:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "code": 404,\n  "message": "Command not found: invalidCommand"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Execution Failed:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": 500,\n  "log": "cleanExpiredSessions execution failed",\n  "full_message": "Database connection error: Connection refused"\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"use-case-product-catalog-export",children:"Use Case: Product Catalog Export"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"class ProductCatalogExporter {\n  constructor(apiBase, token) {\n    this.exporter = new ExportManager(apiBase, token);\n  }\n\n  async exportActiveProducts(categoryId = null) {\n    // Build filter\n    let filter = 'XPRD06 eq true';\n    if (categoryId) {\n      filter += ` AND XPRD05 eq '${categoryId}'`;\n    }\n\n    // Trigger export with progress UI\n    const progressModal = this.showProgressModal();\n\n    try {\n      const resourceId = await this.exporter.triggerExport('PRD', {\n        source: 'productExport',\n        $filter: filter,\n        $select: 'PRD_ID,XPRD01,XPRD02,XPRD05',\n        $order: 'XPRD01 ASC'\n      });\n\n      // Poll with progress updates\n      const result = await this.exporter.pollExport(resourceId, (status) => {\n        progressModal.update({\n          progress: status.progress || 0,\n          message: `Processing ${status.processedRecords || 0} of ${status.totalRecords || 0} products...`\n        });\n      });\n\n      // Download completed export\n      progressModal.hide();\n      this.downloadFile(result.downloadUrl, 'products.csv');\n\n      return result;\n    } catch (error) {\n      progressModal.hide();\n      this.showError(`Export failed: ${error.message}`);\n      throw error;\n    }\n  }\n\n  showProgressModal() {\n    // Create progress modal\n    const modal = document.createElement('div');\n    modal.className = 'export-progress-modal';\n    modal.innerHTML = `\n      <div class=\"progress-content\">\n        <h3>Exporting Products</h3>\n        <div class=\"progress-bar\">\n          <div class=\"progress-fill\" style=\"width: 0%\"></div>\n        </div>\n        <p class=\"progress-message\">Preparing export...</p>\n      </div>\n    `;\n    document.body.appendChild(modal);\n\n    return {\n      update: ({ progress, message }) => {\n        modal.querySelector('.progress-fill').style.width = `${progress}%`;\n        modal.querySelector('.progress-message').textContent = message;\n      },\n      hide: () => modal.remove()\n    };\n  }\n\n  downloadFile(url, filename) {\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n  }\n\n  showError(message) {\n    alert(message);\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"Command operations provide:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Data export with async processing"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 System maintenance tasks"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Custom business logic execution"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Status polling for long-running operations"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Structured command output"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Symfony Console integration via HTTP"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Takeaways:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"GET /api/v4/export/{dim}"})," for data exports"]}),"\n",(0,r.jsxs)(n.li,{children:["Poll ",(0,r.jsx)(n.code,{children:"GET /api/v4/export/status/{resourceId}"})," for export status"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"POST /api/v4/core/command/{commandName}"})," for system commands"]}),"\n",(0,r.jsx)(n.li,{children:"Commands execute Symfony Console Commands via HTTP"}),"\n",(0,r.jsx)(n.li,{children:"Always handle async operations with polling"}),"\n",(0,r.jsx)(n.li,{children:"Provide user feedback during long-running operations"}),"\n",(0,r.jsx)(n.li,{children:"Commands require appropriate permissions (admin for maintenance)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Next:"})," ",(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/batch-operations",children:"Batch Operations \u2192"})]}),"\n",(0,r.jsx)(n.h2,{id:"related-concepts",children:"Related Concepts"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/read-operations",children:"Read Operations"})," - Filters apply to exports"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/permissions",children:"Permissions"})," - Command authorization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/write-operations",children:"Write Operations"})," - Background processing patterns"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},2172:(e,n,s)=>{s.d(n,{I:()=>a,M:()=>i});var r=s(1504);const o={},t=r.createContext(o);function i(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);