"use strict";(self.webpackChunkq_01_docs=self.webpackChunkq_01_docs||[]).push([[2784],{9528:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>d,toc:()=>c});var r=s(7624),a=s(2172);const i={title:"Cascade Operations",sidebar_label:"9. Cascade Operations",sidebar_position:10,description:"Metadata-driven automatic propagation of create, update, and delete operations across related dimensions"},l="Cascade Operations",d={id:"products/map.q01.io/core-api-platform-v4/core-concepts/cascades",title:"Cascade Operations",description:"Metadata-driven automatic propagation of create, update, and delete operations across related dimensions",source:"@site/docs/products/map.q01.io/core-api-platform-v4/01-core-concepts/cascades.md",sourceDirName:"products/map.q01.io/core-api-platform-v4/01-core-concepts",slug:"/products/map.q01.io/core-api-platform-v4/core-concepts/cascades",permalink:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/cascades",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{title:"Cascade Operations",sidebar_label:"9. Cascade Operations",sidebar_position:10,description:"Metadata-driven automatic propagation of create, update, and delete operations across related dimensions"},sidebar:"mapSidebar",previous:{title:"8. Entity Lifecycle",permalink:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/entity-lifecycle"},next:{title:"10. Outbox Pattern",permalink:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/outbox-pattern"}},t={},c=[{value:"What Are Cascade Operations?",id:"what-are-cascade-operations",level:2},{value:"Why Cascades Matter",id:"why-cascades-matter",level:2},{value:"The Three Cascade Types",id:"the-three-cascade-types",level:2},{value:"INSERT_CASCADE",id:"insert_cascade",level:2},{value:"What It Does",id:"what-it-does",level:3},{value:"Metadata Structure",id:"metadata-structure",level:3},{value:"Example: Order with Default Item",id:"example-order-with-default-item",level:3},{value:"Multi-Insert Cascade",id:"multi-insert-cascade",level:3},{value:"UPDATE_CASCADE",id:"update_cascade",level:2},{value:"What It Does",id:"what-it-does-1",level:3},{value:"Metadata Structure",id:"metadata-structure-1",level:3},{value:"Example: Update Order Code",id:"example-update-order-code",level:3},{value:"Extra Conditions",id:"extra-conditions",level:3},{value:"DELETE_CASCADE",id:"delete_cascade",level:2},{value:"What It Does",id:"what-it-does-2",level:3},{value:"Metadata Structure",id:"metadata-structure-2",level:3},{value:"Example: Delete Order and Items",id:"example-delete-order-and-items",level:3},{value:"Physical Delete Cascade",id:"physical-delete-cascade",level:3},{value:"Cascade and Outbox Pattern",id:"cascade-and-outbox-pattern",level:2},{value:"Example: Delete Order with Outbox",id:"example-delete-order-with-outbox",level:3},{value:"Multi-Level Cascades",id:"multi-level-cascades",level:2},{value:"Configuring Cascades in TB_COST",id:"configuring-cascades-in-tb_cost",level:2},{value:"INSERT_CASCADE Example",id:"insert_cascade-example",level:3},{value:"UPDATE_CASCADE Example",id:"update_cascade-example",level:3},{value:"DELETE_CASCADE Example",id:"delete_cascade-example",level:3},{value:"Transaction Guarantees",id:"transaction-guarantees",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"\u2705 DO: Use Soft Delete Cascades",id:"-do-use-soft-delete-cascades",level:3},{value:"\u2705 DO: Configure Bidirectional Updates",id:"-do-configure-bidirectional-updates",level:3},{value:"\u2705 DO: Use Extra Conditions for Selective Cascades",id:"-do-use-extra-conditions-for-selective-cascades",level:3},{value:"\u2705 DO: Test Cascade Chains",id:"-do-test-cascade-chains",level:3},{value:"\u274c DON&#39;T: Cascade on Non-Key Fields",id:"-dont-cascade-on-non-key-fields",level:3},{value:"\u274c DON&#39;T: Create Circular Cascades",id:"-dont-create-circular-cascades",level:3},{value:"\u274c DON&#39;T: Mix Physical and Soft Deletes",id:"-dont-mix-physical-and-soft-deletes",level:3},{value:"Common Pitfalls",id:"common-pitfalls",level:2},{value:"Pitfall 1: Forgetting to Configure Both Directions",id:"pitfall-1-forgetting-to-configure-both-directions",level:3},{value:"Pitfall 2: Cascade Performance on Large Datasets",id:"pitfall-2-cascade-performance-on-large-datasets",level:3},{value:"Pitfall 3: Not Validating Cascade Permissions",id:"pitfall-3-not-validating-cascade-permissions",level:3},{value:"Summary",id:"summary",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"cascade-operations",children:"Cascade Operations"}),"\n",(0,r.jsx)(n.h2,{id:"what-are-cascade-operations",children:"What Are Cascade Operations?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cascade operations"})," are metadata-driven automatic propagations of CRUD operations across related dimensions (entity types). When you create, update, or delete a parent record, CoreWrite automatically performs corresponding operations on child records."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Insight:"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Cascades are ",(0,r.jsx)(n.strong,{children:"not hardcoded foreign key constraints"})," - they're flexible, metadata-configured relationships that maintain referential integrity while providing full control over propagation behavior."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"why-cascades-matter",children:"Why Cascades Matter"}),"\n",(0,r.jsxs)(n.p,{children:["Traditional database foreign keys with ",(0,r.jsx)(n.code,{children:"ON DELETE CASCADE"})," are rigid:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u274c All-or-nothing cascading"}),"\n",(0,r.jsx)(n.li,{children:"\u274c No custom logic during propagation"}),"\n",(0,r.jsx)(n.li,{children:"\u274c No outbox event publishing for cascaded changes"}),"\n",(0,r.jsx)(n.li,{children:"\u274c No soft delete support"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Q01 Cascades provide:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Metadata-driven"})," - Configure in TB_COST, not SQL DDL"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Soft delete aware"})," - Cascade TREC='C' instead of physical delete"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Event publishing"})," - Every cascaded operation goes to outbox"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Transactional"})," - All cascades in single ACID transaction"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Flexible mappings"})," - Transform data during cascade"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Conditional propagation"})," - Add extra conditions"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"the-three-cascade-types",children:"The Three Cascade Types"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Cascade Type"}),(0,r.jsx)(n.th,{children:"Trigger"}),(0,r.jsx)(n.th,{children:"Purpose"}),(0,r.jsx)(n.th,{children:"Code Reference"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"INSERT_CASCADE"})}),(0,r.jsx)(n.td,{children:"Parent record created (POST)"}),(0,r.jsx)(n.td,{children:"Auto-create related child records"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"DataStore.php:1372"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"UPDATE_CASCADE"})}),(0,r.jsx)(n.td,{children:"Parent key field updated (PUT/PATCH)"}),(0,r.jsx)(n.td,{children:"Update foreign keys in child records"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"DataStore.php:1878"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"DELETE_CASCADE"})}),(0,r.jsx)(n.td,{children:"Parent record deleted (DELETE)"}),(0,r.jsx)(n.td,{children:"Soft delete child records (TREC='C')"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"DataStore.php:2361"})})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"insert_cascade",children:"INSERT_CASCADE"}),"\n",(0,r.jsx)(n.h3,{id:"what-it-does",children:"What It Does"}),"\n",(0,r.jsxs)(n.p,{children:["When you ",(0,r.jsx)(n.strong,{children:"create"})," a parent record, automatically create related child records."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Creating order with default line items"}),"\n",(0,r.jsx)(n.li,{children:"Creating user with default settings"}),"\n",(0,r.jsx)(n.li,{children:"Creating product with default pricing tiers"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"metadata-structure",children:"Metadata Structure"}),"\n",(0,r.jsx)(n.p,{children:"Configured in dimension metadata (loaded by CoreWrite):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'INSERT_CASCADE' => [\n    'CHILD_DIM' => [\n        'replace' => [\n            'PARENT_FIELD' => 'CHILD_FIELD'\n        ],\n        'body' => [\n            [\n                'CHILD_FIELD_1' => 'value1',\n                'CHILD_FIELD_2' => 'value2'\n            ]\n        ]\n    ]\n]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fields:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"CHILD_DIM"}),": Child dimension code (e.g., 'ORDITEM')"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"replace"}),": Field mapping from parent to child"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"body"}),": Array of records to create (can be multiple)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-order-with-default-item",children:"Example: Order with Default Item"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario:"}),' When creating an order, automatically create a default "Shipping Fee" line item.']}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Metadata Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// In ORD dimension metadata\n'INSERT_CASCADE' => [\n    'ORDITEM' => [\n        'replace' => [\n            'ORD_ID' => 'XORDITEM01'  // Map parent ID to child FK\n        ],\n        'body' => [\n            [\n                'XORDITEM01' => 'Shipping Fee',\n                'XORDITEM02' => 9.99,\n                'XORDITEM03' => 1  // quantity\n            ]\n        ]\n    ]\n]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Create Order Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:'POST /api/v4/core/ORD\n{\n  "XORD01": "2025-01-19",\n  "XORD02": "John Doe",\n  "source": "orderCreate"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What Happens:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Parent INSERT:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INSERT INTO TB_ANAG_ORD00 (XORD01, XORD02, OWNER, CDATA, LOWNER, LDATA, TREC)\nVALUES ('2025-01-19', 'John Doe', 'user_5', '20250119120000', 'user_5', '20250119120000', 'N');\n\n-- Returns ORD_ID = 555\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Cascade INSERT (automatic):"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INSERT INTO TB_ANAG_ORDITEM00 (\n  XORDITEM01,  -- Replaced with ORD_ID=555\n  XORDITEM01,\n  XORDITEM02,\n  XORDITEM03,\n  OWNER, CDATA, LOWNER, LDATA, TREC\n) VALUES (\n  555,  -- From parent ORD_ID\n  'Shipping Fee',\n  9.99,\n  1,\n  'user_5', '20250119120000', 'user_5', '20250119120000', 'N'\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'[{\n  "code": 201,\n  "insertedId": "555",\n  "body": {\n    "XORD01": "2025-01-19",\n    "XORD02": "John Doe"\n  },\n  "INSERT_CASCADE": {\n    "ORDITEM": {\n      "0": {\n        "code": 201,\n        "insertedId": "1001"\n      }\n    }\n  }\n}]\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Code Reference:"})," ",(0,r.jsx)(n.code,{children:"DataStore.php:1372-1823"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"if (sizeof($this->curr_metadata) && isset($this->curr_metadata['INSERT_CASCADE'])) {\n    foreach ($this->curr_metadata['INSERT_CASCADE'] as $tbl => $cascadeInfo) {\n        $replaceArray = $cascadeInfo['replace'];\n        $currBody = $cascadeInfo['body'];\n        // ... insert child records\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"multi-insert-cascade",children:"Multi-Insert Cascade"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Multiple Child Records:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'INSERT_CASCADE' => [\n    'ORDITEM' => [\n        'replace' => [\n            'ORD_ID' => 'XORDITEM01'\n        ],\n        'body' => [\n            ['XORDITEM01' => 'Shipping Fee', 'XORDITEM02' => 9.99],\n            ['XORDITEM01' => 'Handling Fee', 'XORDITEM02' => 5.00],\n            ['XORDITEM01' => 'Tax', 'XORDITEM02' => 0.00]\n        ]\n    ]\n]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," Creates 3 child records automatically."]}),"\n",(0,r.jsx)(n.h2,{id:"update_cascade",children:"UPDATE_CASCADE"}),"\n",(0,r.jsx)(n.h3,{id:"what-it-does-1",children:"What It Does"}),"\n",(0,r.jsxs)(n.p,{children:["When you ",(0,r.jsx)(n.strong,{children:"update"})," a parent's key field, automatically update foreign keys in all related child records."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Changing order number (update all line items)"}),"\n",(0,r.jsx)(n.li,{children:"Renaming category (update all products)"}),"\n",(0,r.jsx)(n.li,{children:"Updating customer ID (update all addresses)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"metadata-structure-1",children:"Metadata Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'UPDATE_CASCADE' => [\n    'srcKey' => 'PARENT_KEY_FIELD',\n    'applyTo' => [\n        'CHILD_DIM' => [\n            'destKey' => 'CHILD_FK_FIELD',\n            'extraCond' => ''  // Optional additional WHERE clause\n        ]\n    ]\n]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fields:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"srcKey"}),": Field in parent dimension being updated"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"applyTo"}),": Array of child dimensions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"destKey"}),": Foreign key field in child dimension"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"extraCond"}),": Optional SQL WHERE condition"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-update-order-code",children:"Example: Update Order Code"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario:"})," When order code changes, update all line items to reference new code."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Metadata Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// In ORD dimension metadata\n'UPDATE_CASCADE' => [\n    'srcKey' => 'XORD02',\n    'applyTo' => [\n        'ORDITEM' => [\n            'destKey' => 'XORDITEM02'\n        ]\n    ]\n]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Update Order Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:'PUT /api/v4/core/ORD/555\n{\n  "XORD02": "ORD-2025-NEW",\n  "source": "orderEdit"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What Happens:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Parent UPDATE:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"UPDATE TB_ANAG_ORD00 SET\n  XORD02 = 'ORD-2025-NEW',\n  LOWNER = 'user_5',\n  LDATA = '20250119130000',\n  TREC = 'M'\nWHERE ORD_ID = 555;\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Cascade UPDATE (automatic):"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"UPDATE TB_ANAG_ORDITEM00 SET\n  XORDITEM02 = 'ORD-2025-NEW',\n  LOWNER = 'user_5',\n  LDATA = '20250119130000',\n  TREC = 'M'\nWHERE XORDITEM02 = 'ORD-2025-OLD';  -- Old value\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Code Reference:"})," ",(0,r.jsx)(n.code,{children:"DataStore.php:1878-2140"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"if ($this->metadata['metadata'] && isset($this->metadata['UPDATE_CASCADE'])) {\n    $srcKeyVal = $param[$this->metadata['UPDATE_CASCADE']['srcKey']];\n\n    foreach ($this->metadata['UPDATE_CASCADE']['applyTo'] as $tbl => $updateInfo) {\n        $destKey = $updateInfo['destKey'];\n        // ... update child records\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"extra-conditions",children:"Extra Conditions"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Add Conditional Logic:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'UPDATE_CASCADE' => [\n    'srcKey' => 'XORD02',\n    'applyTo' => [\n        'ORDITEM' => [\n            'destKey' => 'XORDITEM02',\n            'extraCond' => \"AND XORDITEM05 = 'ACTIVE'\"  // Only update active items\n        ]\n    ]\n]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Generated SQL:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"UPDATE TB_ANAG_ORDITEM00 SET\n  XORDITEM02 = 'ORD-2025-NEW',\n  LOWNER = 'user_5',\n  LDATA = '20250119130000',\n  TREC = 'M'\nWHERE XORDITEM02 = 'ORD-2025-OLD'\n  AND XORDITEM05 = 'ACTIVE';  -- Extra condition\n"})}),"\n",(0,r.jsx)(n.h2,{id:"delete_cascade",children:"DELETE_CASCADE"}),"\n",(0,r.jsx)(n.h3,{id:"what-it-does-2",children:"What It Does"}),"\n",(0,r.jsxs)(n.p,{children:["When you ",(0,r.jsx)(n.strong,{children:"delete"})," a parent record, automatically soft delete (TREC='C') all related child records."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Behavior:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Soft delete by default"})," - Sets TREC='C' on children"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Physical delete if parent forced"})," - If ",(0,r.jsx)(n.code,{children:"forceDelete=true"}),", physically deletes children too"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Outbox events"})," - Publishes delete event for each child"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Deleting order deletes all line items"}),"\n",(0,r.jsx)(n.li,{children:"Deleting category soft-deletes all products"}),"\n",(0,r.jsx)(n.li,{children:"Deleting customer soft-deletes all addresses"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"metadata-structure-2",children:"Metadata Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'DELETE_CASCADE' => [\n    'srcKey' => 'PARENT_KEY_FIELD',\n    'applyTo' => [\n        'CHILD_DIM' => 'CHILD_FK_FIELD'\n    ]\n]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fields:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"srcKey"}),": Field in parent dimension (usually primary key)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"applyTo"}),": Map of child dimensions to foreign key fields"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-delete-order-and-items",children:"Example: Delete Order and Items"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Metadata Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// In ORD dimension metadata\n'DELETE_CASCADE' => [\n    'srcKey' => 'ORD_ID',\n    'applyTo' => [\n        'ORDITEM' => 'XORDITEM01'\n    ]\n]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Delete Order Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"DELETE /api/v4/core/ORD/555\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What Happens:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Lookup Parent Key:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT ORD_ID as KEYVAL FROM TB_ANAG_ORD00 WHERE ORD_ID = 555;\n-- Returns KEYVAL = 555\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Cascade Soft Delete (automatic):"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"UPDATE TB_ANAG_ORDITEM00 SET\n  TREC = 'C',\n  LDATA = '20250119140000'\nWHERE XORDITEM01 = 555;\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Parent Soft Delete:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"UPDATE TB_ANAG_ORD00 SET\n  TREC = 'C',\n  LOWNER = 'user_5',\n  LDATA = '20250119140000'\nWHERE ORD_ID = 555;\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," Order and all line items now have TREC='C', recoverable."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Code Reference:"})," ",(0,r.jsx)(n.code,{children:"DataStore.php:2361-2380"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"if ($metadata['metadata'] && isset($metadata['DELETE_CASCADE'])) {\n    $sql = \"select {$metadata['DELETE_CASCADE']['srcKey']} as KEYVAL\n            from TB_ANAG_{$dim}00 where {$dim}_ID = ?\";\n    $cascadeVal = $data['KEYVAL'];\n\n    foreach ($metadata['DELETE_CASCADE']['applyTo'] as $tbl => $joinField) {\n        $q = \"update TB_ANAG_{$tbl}00 set TREC = 'C', LDATA = '\" . date(\"YmdHis\") . \"'\n              where {$joinField} = '{$cascadeVal}'\";\n        // ... execute cascade delete\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"physical-delete-cascade",children:"Physical Delete Cascade"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Force Delete Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"DELETE /api/v4/core/ORD/555?forceDelete=true\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cascade Physical Delete:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Delete children first\nDELETE FROM TB_ANAG_ORDITEM00 WHERE XORDITEM01 = 555;\n\n-- Then delete parent\nDELETE FROM TB_ANAG_ORD00 WHERE ORD_ID = 555;\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Warning:"})," Irreversible - no TREC='C', no recovery."]}),"\n",(0,r.jsx)(n.h2,{id:"cascade-and-outbox-pattern",children:"Cascade and Outbox Pattern"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Critical:"})," All cascade operations publish events to TB_ANAG_OUTBOX00."]}),"\n",(0,r.jsx)(n.h3,{id:"example-delete-order-with-outbox",children:"Example: Delete Order with Outbox"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Delete Operation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"DELETE /api/v4/core/ORD/555\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Outbox Entries Created:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Parent Delete Event:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "XOUTBOX01": "ORD",\n  "XOUTBOX02": "logicalDelete",\n  "XOUTBOX03": "{\\"ORD_ID\\": \\"555\\"}",\n  "XOUTBOX04": "2025-01-19 14:00:00",\n  "XOUTBOX05": 0\n}\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Cascaded Child Delete Event:"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "XOUTBOX01": "ORDITEM",\n  "XOUTBOX02": "logicalDelete",\n  "XOUTBOX03": "{\\"XORDITEM01\\": \\"555\\"}",\n  "XOUTBOX04": "2025-01-19 14:00:00",\n  "XOUTBOX05": 0\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," RabbitMQ fanout exchange publishes both events, consumers notified."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Code Reference:"})," ",(0,r.jsx)(n.code,{children:"DataStore.php:2377-2380"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"$sqlOutboxDelete[$i] = [\n    \"dim\" => $tbl,\n    'delete_keys' => [\n        $joinField => $cascadeVal\n    ]\n];\n"})}),"\n",(0,r.jsx)(n.h2,{id:"multi-level-cascades",children:"Multi-Level Cascades"}),"\n",(0,r.jsx)(n.p,{children:"Cascades can chain across multiple levels:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ORDER (parent)\n  \u2514\u2500 ORDITEM (child, has DELETE_CASCADE)\n       \u2514\u2500 ORDITEM_DISCOUNT (grandchild, has DELETE_CASCADE)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Delete Order 555:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"DELETE_CASCADE: ORD \u2192 ORDITEM"}),"\n",(0,r.jsx)(n.li,{children:"DELETE_CASCADE: ORDITEM \u2192 ORDITEM_DISCOUNT (triggered by step 1)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," All three levels soft deleted (TREC='C')."]}),"\n",(0,r.jsx)(n.h2,{id:"configuring-cascades-in-tb_cost",children:"Configuring Cascades in TB_COST"}),"\n",(0,r.jsx)(n.p,{children:"While cascade metadata is typically loaded programmatically, TB_COST stores relationship information:"}),"\n",(0,r.jsx)(n.h3,{id:"insert_cascade-example",children:"INSERT_CASCADE Example"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Field Definition:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INSERT INTO TB_COST (\n  DIM_COD, COD_COST, DESC_COST, TIPO_CAMPO,\n  COD_ON_OFF, COD_SEQUENZA, INSERT_CASCADE, ...\n) VALUES (\n  'ORD', 'ORD_ID', 'Order ID', 'int',\n  'L,D', 10, 'ORDITEM:XORDITEM01', ...\n);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"INSERT_CASCADE Format:"})," ",(0,r.jsx)(n.code,{children:"CHILD_DIM:CHILD_FK_FIELD"})]}),"\n",(0,r.jsx)(n.h3,{id:"update_cascade-example",children:"UPDATE_CASCADE Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INSERT INTO TB_COST (\n  DIM_COD, COD_COST, UPDATE_CASCADE, ...\n) VALUES (\n  'ORD', 'XORD02', 'ORDITEM:XORDITEM02', ...\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"delete_cascade-example",children:"DELETE_CASCADE Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INSERT INTO TB_COST (\n  DIM_COD, COD_COST, DELETE_CASCADE, ...\n) VALUES (\n  'ORD', 'ORD_ID', 'ORDITEM:XORDITEM01,ORDNOTE:XORDNOTE01', ...\n);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Multiple Children:"})," Comma-separated ",(0,r.jsx)(n.code,{children:"CHILD1:FK1,CHILD2:FK2"})]}),"\n",(0,r.jsx)(n.h2,{id:"transaction-guarantees",children:"Transaction Guarantees"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"All cascades execute in a single ACID transaction:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"try {\n    $this->db_data->beginTransaction();\n\n    // 1. Execute parent operation\n    // 2. Execute cascade operations\n    // 3. Write to outbox\n\n    $this->db_data->commit();\n} catch (Exception $e) {\n    $this->db_data->rollback();\n    // All changes rolled back - no partial cascades\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Guarantee:"})," Either ",(0,r.jsx)(n.strong,{children:"all"})," operations succeed or ",(0,r.jsx)(n.strong,{children:"none"})," do."]}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"-do-use-soft-delete-cascades",children:"\u2705 DO: Use Soft Delete Cascades"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prefer TREC='C' propagation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'DELETE_CASCADE' => [\n    'srcKey' => 'ORD_ID',\n    'applyTo' => [\n        'ORDITEM' => 'XORDITEM01'\n    ]\n]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Benefit:"})," Recoverable, maintains audit trail."]}),"\n",(0,r.jsx)(n.h3,{id:"-do-configure-bidirectional-updates",children:"\u2705 DO: Configure Bidirectional Updates"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example:"})," Category name change updates products:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// In CATEGORY dimension\n'UPDATE_CASCADE' => [\n    'srcKey' => 'XCAT_NAME',\n    'applyTo' => [\n        'PRODUCT' => ['destKey' => 'XPRD05_NAME']\n    ]\n]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"-do-use-extra-conditions-for-selective-cascades",children:"\u2705 DO: Use Extra Conditions for Selective Cascades"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Only update active records:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'UPDATE_CASCADE' => [\n    'srcKey' => 'XORD04',\n    'applyTo' => [\n        'ORDITEM' => [\n            'destKey' => 'XORDITEM03',\n            'extraCond' => \"AND XORDITEM06 = 0\"\n        ]\n    ]\n]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"-do-test-cascade-chains",children:"\u2705 DO: Test Cascade Chains"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Multi-level cascades require testing:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Create parent with cascade"}),"\n",(0,r.jsx)(n.li,{children:"Update parent key"}),"\n",(0,r.jsx)(n.li,{children:"Delete parent"}),"\n",(0,r.jsx)(n.li,{children:"Verify all levels affected correctly"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"-dont-cascade-on-non-key-fields",children:"\u274c DON'T: Cascade on Non-Key Fields"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Wrong:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'UPDATE_CASCADE' => [\n    'srcKey' => 'XORD03',  // Not a key field!\n    'applyTo' => [...]\n]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why:"})," Performance - updates trigger cascade on every total recalculation."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Right:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Only cascade on key fields (IDs, codes)\n'UPDATE_CASCADE' => [\n    'srcKey' => 'XORD02',\n    'applyTo' => [...]\n]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"-dont-create-circular-cascades",children:"\u274c DON'T: Create Circular Cascades"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Wrong:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// ORD dimension\n'UPDATE_CASCADE' => ['applyTo' => ['ORDITEM' => [...]]]\n\n// ORDITEM dimension\n'UPDATE_CASCADE' => ['applyTo' => ['ORD' => [...]]]  // Circular!\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why:"})," Infinite loop, transaction timeout."]}),"\n",(0,r.jsx)(n.h3,{id:"-dont-mix-physical-and-soft-deletes",children:"\u274c DON'T: Mix Physical and Soft Deletes"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Wrong:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Parent: soft delete\nDELETE /api/v4/core/ORD/555\n\n// Child: force delete (inconsistent)\nDELETE /api/v4/core/ORDITEM/1001?forceDelete=true\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why:"})," Parent TREC='C' but child physically gone - referential integrity broken."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Right:"})," Both soft delete or both physical delete."]}),"\n",(0,r.jsx)(n.h2,{id:"common-pitfalls",children:"Common Pitfalls"}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-1-forgetting-to-configure-both-directions",children:"Pitfall 1: Forgetting to Configure Both Directions"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem:"})," Configured DELETE_CASCADE but forgot INSERT_CASCADE."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Scenario:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Delete order \u2192 items cascaded \u2705"}),"\n",(0,r.jsx)(n.li,{children:"Create order \u2192 items not created \u274c"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Configure INSERT_CASCADE for default items:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"'INSERT_CASCADE' => [\n    'ORDITEM' => [...]\n]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-2-cascade-performance-on-large-datasets",children:"Pitfall 2: Cascade Performance on Large Datasets"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem:"})," Deleting parent with 10,000 children times out."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Add pagination or async processing:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Option 1: Batch delete children first\nDELETE FROM TB_ANAG_ORDITEM00\nWHERE XORDITEM01 = 555\nLIMIT 1000;\n\n// Option 2: Queue for background processing\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-3-not-validating-cascade-permissions",children:"Pitfall 3: Not Validating Cascade Permissions"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem:"})," User has permission to delete parent but not children - cascade fails."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Validate permissions before cascade:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"// Check user has grant for both ORD and ORDITEM\nif (!hasGrant('ORD', 4) || !hasGrant('ORDITEM', 4)) {\n    throw new PermissionException();\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cascade Operations"})," provide:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Automatic relationship maintenance"})," - No manual child record management"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Metadata-driven configuration"})," - Define once in TB_COST"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"ACID guarantees"})," - All or nothing, no partial cascades"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Soft delete support"})," - TREC='C' propagation preserves data"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Event publishing"})," - Outbox pattern for every cascaded operation"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Flexible conditions"})," - Extra WHERE clauses, field mappings"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Insight:"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Cascades are the ",(0,r.jsx)(n.strong,{children:"referential integrity engine"})," of Q01 Core APIs. Configure relationships in metadata, CoreWrite handles the rest - transactionally, consistently, with full event publishing."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Next Concept:"})}),"\n",(0,r.jsxs)(n.p,{children:["Continue to ",(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/outbox-pattern",children:"Outbox Pattern"})," to understand how cascade events guarantee eventual consistency across distributed systems."]})]})}function h(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},2172:(e,n,s)=>{s.d(n,{I:()=>d,M:()=>l});var r=s(1504);const a={},i=r.createContext(a);function l(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);