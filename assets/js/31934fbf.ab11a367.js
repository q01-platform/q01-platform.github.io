"use strict";(self.webpackChunkq_01_docs=self.webpackChunkq_01_docs||[]).push([[1120],{9300:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>l});var s=r(7624),i=r(2172);const t={title:"Write Operations (POST/PUT/PATCH/DELETE)",sidebar_label:"Write Operations",sidebar_position:3,description:"Creating, updating, and deleting data with validation, cascades, and outbox publishing"},d="Write Operations (POST/PUT/PATCH/DELETE)",o={id:"products/map.q01.io/core-api-platform-v4/api-operations/write-operations",title:"Write Operations (POST/PUT/PATCH/DELETE)",description:"Creating, updating, and deleting data with validation, cascades, and outbox publishing",source:"@site/docs/products/map.q01.io/core-api-platform-v4/02-api-operations/write-operations.md",sourceDirName:"products/map.q01.io/core-api-platform-v4/02-api-operations",slug:"/products/map.q01.io/core-api-platform-v4/api-operations/write-operations",permalink:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/write-operations",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Write Operations (POST/PUT/PATCH/DELETE)",sidebar_label:"Write Operations",sidebar_position:3,description:"Creating, updating, and deleting data with validation, cascades, and outbox publishing"},sidebar:"mapSidebar",previous:{title:"Read Operations",permalink:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/read-operations"},next:{title:"Field Metadata",permalink:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/field-metadata"}},c={},l=[{value:"Overview",id:"overview",level:2},{value:"Operation Types",id:"operation-types",level:2},{value:"CREATE Operation (POST)",id:"create-operation-post",level:2},{value:"Basic Endpoint",id:"basic-endpoint",level:3},{value:"Request Format",id:"request-format",level:3},{value:"Example Request",id:"example-request",level:3},{value:"Response Format",id:"response-format",level:3},{value:"What Happens Internally",id:"what-happens-internally",level:3},{value:"Pre-Insert Functions",id:"pre-insert-functions",level:3},{value:"Validation Errors",id:"validation-errors",level:3},{value:"UPDATE Operation (PUT)",id:"update-operation-put",level:2},{value:"Full Update - Replace All Fields",id:"full-update---replace-all-fields",level:3},{value:"Transaction Flow",id:"transaction-flow",level:3},{value:"PARTIAL UPDATE Operation (PATCH)",id:"partial-update-operation-patch",level:2},{value:"Update Specific Fields Only",id:"update-specific-fields-only",level:3},{value:"PUT vs PATCH",id:"put-vs-patch",level:3},{value:"DELETE Operation",id:"delete-operation",level:2},{value:"Soft Delete (Default)",id:"soft-delete-default",level:3},{value:"Physical Delete (Force)",id:"physical-delete-force",level:3},{value:"Delete with Cascades",id:"delete-with-cascades",level:3},{value:"Field Visibility and COD_ON_OFF",id:"field-visibility-and-cod_on_off",level:2},{value:"Creating Records (center_dett=nuovo)",id:"creating-records-center_dettnuovo",level:3},{value:"Updating Records (center_dett=modifica)",id:"updating-records-center_dettmodifica",level:3},{value:"Outbox Pattern Integration",id:"outbox-pattern-integration",level:2},{value:"Every Write Operation Publishes Event",id:"every-write-operation-publishes-event",level:3},{value:"Practical Examples",id:"practical-examples",level:2},{value:"Example 1: Create Product with Validation",id:"example-1-create-product-with-validation",level:3},{value:"Example 2: Update Product Price",id:"example-2-update-product-price",level:3},{value:"Example 3: Soft Delete with Recovery",id:"example-3-soft-delete-with-recovery",level:3},{value:"Example 4: Bulk Create with Transaction",id:"example-4-bulk-create-with-transaction",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Common Error Patterns",id:"common-error-patterns",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"\u2705 DO: Use PATCH for Updates",id:"-do-use-patch-for-updates",level:3},{value:"\u2705 DO: Use Soft Delete by Default",id:"-do-use-soft-delete-by-default",level:3},{value:"\u2705 DO: Validate Before Sending",id:"-do-validate-before-sending",level:3},{value:"\u2705 DO: Handle Errors Gracefully",id:"-do-handle-errors-gracefully",level:3},{value:"\u274c DON&#39;T: Send Fields Not Visible in Context",id:"-dont-send-fields-not-visible-in-context",level:3},{value:"\u274c DON&#39;T: Manually Set Audit Fields",id:"-dont-manually-set-audit-fields",level:3},{value:"\u274c DON&#39;T: Use forceDelete Without Confirmation",id:"-dont-use-forcedelete-without-confirmation",level:3},{value:"Summary",id:"summary",level:2}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"write-operations-postputpatchdelete",children:"Write Operations (POST/PUT/PATCH/DELETE)"}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Write operations"})," create, update, and delete data using POST, PUT, PATCH, and DELETE requests to CoreService. Requests are transparently routed to ",(0,s.jsx)(n.strong,{children:"CoreWrite"})," backend for transactional CRUD operations."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Principle:"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"POST/PUT/PATCH/DELETE requests to CoreService automatically route to CoreWrite. CoreWrite handles validation, pre-insert functions, cascades, TREC management, and outbox publishing - all in a single ACID transaction."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"operation-types",children:"Operation Types"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"HTTP Method"}),(0,s.jsx)(n.th,{children:"Operation"}),(0,s.jsx)(n.th,{children:"Endpoint"}),(0,s.jsx)(n.th,{children:"TREC State"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"POST"})}),(0,s.jsx)(n.td,{children:"Create new record"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v4/core/{DIM}"})}),(0,s.jsx)(n.td,{children:"Sets TREC='N'"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUT"})}),(0,s.jsx)(n.td,{children:"Full update (all fields)"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v4/core/{DIM}/{ID}"})}),(0,s.jsx)(n.td,{children:"Sets TREC='M'"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PATCH"})}),(0,s.jsx)(n.td,{children:"Partial update (some fields)"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v4/core/{DIM}/{ID}"})}),(0,s.jsx)(n.td,{children:"Sets TREC='M'"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"DELETE"})}),(0,s.jsx)(n.td,{children:"Delete record (soft/hard)"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v4/core/{DIM}/{ID}"})}),(0,s.jsx)(n.td,{children:"Sets TREC='C' or removes"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"create-operation-post",children:"CREATE Operation (POST)"}),"\n",(0,s.jsx)(n.h3,{id:"basic-endpoint",children:"Basic Endpoint"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"POST /api/v4/core/{DIM}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"request-format",children:"Request Format"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Headers:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-http",children:"Authorization: Bearer {JWT_TOKEN}\nContent-Type: application/json\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Body:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XPRD01": "Premium Widget",\n  "XPRD02": 49.99,\n  "XPRD06": true,\n  "source": "productCreate"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Required:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"source"}),": Security area (must have grant level \u2265 4 for create)"]}),"\n",(0,s.jsx)(n.li,{children:"Fields marked as required in TB_COST"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"example-request",children:"Example Request"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X POST "https://coreservice.q01.io/api/v4/core/PRD" \\\n  -H "Authorization: Bearer eyJhbGc..." \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "XPRD01": "Premium Widget",\n    "XPRD02": 49.99,\n    "XPRD06": true,\n    "XPRD05": "Electronics",\n    "source": "productCreate"\n  }\'\n'})}),"\n",(0,s.jsx)(n.h3,{id:"response-format",children:"Response Format"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Success (201 Created):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'[{\n  "code": 201,\n  "insertedId": "123",\n  "body": {\n    "XPRD01": "Premium Widget",\n    "XPRD02": 49.99,\n    "XPRD06": true,\n    "XPRD05": "Electronics"\n  },\n  "fields": {\n    "PRD_ID": {\n      "type": "int",\n      "value": "123"\n    },\n    "XPRD01": {\n      "type": "varchar",\n      "value": "Premium Widget"\n    }\n  }\n}]\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response Fields:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"code"}),": HTTP status code (201 for success)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"insertedId"}),": Primary key value of created record"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"body"}),": Echo of request data"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"fields"}),": Field metadata from TB_COST"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"what-happens-internally",children:"What Happens Internally"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"CoreWrite transaction flow:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"1. Validate JWT & permissions (grant \u2265 4 for create)\n2. Load metadata (TB_DIM, TB_COST)\n3. Validate required fields\n4. Execute pre-insert functions (uuid, slugify, current_user, etc.)\n5. BEGIN TRANSACTION\n6. INSERT into TB_ANAG_{DIM}00\n   - Auto-populate: OWNER, CDATA, LOWNER, LDATA, TIMESTAMP, TREC='N'\n7. Execute INSERT_CASCADE (create child records)\n8. Write to TB_ANAG_OUTBOX00 (event: \"create\")\n9. COMMIT TRANSACTION\n10. Return insertedId + metadata\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Guarantee:"})," Either all steps succeed or all are rolled back (ACID)."]}),"\n",(0,s.jsx)(n.h3,{id:"pre-insert-functions",children:"Pre-Insert Functions"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Fields with pre-insert functions are auto-populated:"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"TB_COST Configuration:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- UUID field\nINSERT INTO TB_COST (DIM_COD, COD_COST, FUNCTION, ...)\nVALUES ('PRD', 'XPRD10', 'BI|uuid|microtime', ...);\n\n-- Slug field\nINSERT INTO TB_COST (DIM_COD, COD_COST, FUNCTION, ...)\nVALUES ('PRD', 'XPRD11', 'BI|slugify|XPRD01', ...);\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Request (minimal):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XPRD01": "Premium Widget",\n  "source": "productCreate"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Result (auto-populated):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "PRD_ID": "123",\n  "XPRD01": "Premium Widget",\n  "XPRD10": "A7F3C2B1-5D4E-5678-9ABC-DEF012345678",\n  "XPRD11": "premium-widget",\n  "OWNER": "user_5",\n  "CDATA": "20250119120000",\n  "TREC": "N"\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Documentation:"})," ",(0,s.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/pre-insert-functions",children:"Pre-Insert Functions"})]}),"\n",(0,s.jsx)(n.h3,{id:"validation-errors",children:"Validation Errors"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Missing Required Field:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X POST "https://coreservice.q01.io/api/v4/core/PRD" \\\n  -H "Authorization: Bearer eyJhbGc..." \\\n  -d \'{"XPRD02": 49.99, "source": "productCreate"}\'\n# Missing XPRD01 (required)\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response (400 Bad Request):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "code": 400,\n  "message": "Validation failed",\n  "errors": [\n    {\n      "field": "XPRD01",\n      "message": "Field is required"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Insufficient Permissions:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# User has grant level 1, but create requires 4\ncurl -X POST "https://coreservice.q01.io/api/v4/core/PRD" \\\n  -H "Authorization: Bearer eyJhbGc..." \\\n  -d \'{"XPRD01": "Widget", "source": "productCreate"}\'\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response (403 Forbidden):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "code": 403,\n  "message": "Forbidden: insufficient grant level for create operation",\n  "errors": [\n    {\n      "field": "source",\n      "message": "Required grant: 4, User grant: 1"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"update-operation-put",children:"UPDATE Operation (PUT)"}),"\n",(0,s.jsx)(n.h3,{id:"full-update---replace-all-fields",children:"Full Update - Replace All Fields"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Endpoint:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"PUT /api/v4/core/{DIM}/{ID}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Replace all modifiable fields (requires all field values)"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Request:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X PUT "https://coreservice.q01.io/api/v4/core/PRD/123" \\\n  -H "Authorization: Bearer eyJhbGc..." \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "XPRD01": "Premium Widget Updated",\n    "XPRD02": 59.99,\n    "XPRD06": true,\n    "XPRD05": "Electronics",\n    "source": "productEdit"\n  }\'\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response (200 OK):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "code": 200,\n  "modifiedId": "123",\n  "body": {\n    "XPRD01": "Premium Widget Updated",\n    "XPRD02": 59.99,\n    "XPRD06": true,\n    "XPRD05": "Electronics"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"transaction-flow",children:"Transaction Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"1. Validate JWT & permissions (grant \u2265 2 for update)\n2. Load existing record\n3. Validate all required fields present\n4. BEGIN TRANSACTION\n5. UPDATE TB_ANAG_{DIM}00 SET\n   - Fields from request body\n   - LOWNER = current user\n   - LDATA = current timestamp\n   - TREC = 'M'\n6. Execute UPDATE_CASCADE (update child foreign keys if needed)\n7. Write to TB_ANAG_OUTBOX00 (event: \"update\")\n8. COMMIT TRANSACTION\n9. Return modifiedId\n"})}),"\n",(0,s.jsx)(n.h2,{id:"partial-update-operation-patch",children:"PARTIAL UPDATE Operation (PATCH)"}),"\n",(0,s.jsx)(n.h3,{id:"update-specific-fields-only",children:"Update Specific Fields Only"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Endpoint:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"PATCH /api/v4/core/{DIM}/{ID}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Update only specified fields (don't need all fields)"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Request:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH "https://coreservice.q01.io/api/v4/core/PRD/123" \\\n  -H "Authorization: Bearer eyJhbGc..." \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "XPRD02": 59.99,\n    "source": "productEdit"\n  }\'\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Only XPRD02 is updated, other fields unchanged."})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response (200 OK):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "code": 200,\n  "modifiedId": "123",\n  "body": {\n    "XPRD02": 59.99\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"put-vs-patch",children:"PUT vs PATCH"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Aspect"}),(0,s.jsx)(n.th,{children:"PUT (Full Update)"}),(0,s.jsx)(n.th,{children:"PATCH (Partial Update)"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Fields"})}),(0,s.jsx)(n.td,{children:"All modifiable fields required"}),(0,s.jsx)(n.td,{children:"Only fields to change"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Unspecified fields"})}),(0,s.jsx)(n.td,{children:"Set to NULL or default"}),(0,s.jsx)(n.td,{children:"Keep existing values"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Use case"})}),(0,s.jsx)(n.td,{children:"Replace entire record"}),(0,s.jsx)(n.td,{children:"Change specific fields"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Request size"})}),(0,s.jsx)(n.td,{children:"Larger (all fields)"}),(0,s.jsx)(n.td,{children:"Smaller (only changes)"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example Comparison:"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"PUT Request:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XPRD01": "Widget",\n  "XPRD02": 59.99,\n  "XPRD06": true,\n  "XPRD05": "Electronics",\n  "XPRD04": "Updated description",\n  "source": "productEdit"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Must include all fields or risk losing data."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"PATCH Request:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XPRD02": 59.99,\n  "source": "productEdit"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Only update price, keep everything else."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Recommendation:"})," Use ",(0,s.jsx)(n.strong,{children:"PATCH"})," for most update operations (safer, more efficient)."]}),"\n",(0,s.jsx)(n.h2,{id:"delete-operation",children:"DELETE Operation"}),"\n",(0,s.jsx)(n.h3,{id:"soft-delete-default",children:"Soft Delete (Default)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Endpoint:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DELETE /api/v4/core/{DIM}/{ID}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Mark record as cancelled (TREC='C'), recoverable"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Request:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X DELETE "https://coreservice.q01.io/api/v4/core/PRD/123?source=productDelete" \\\n  -H "Authorization: Bearer eyJhbGc..."\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response (200 OK):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "code": 200,\n  "message": "Record soft deleted successfully",\n  "deletedId": "123"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What Happens:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"UPDATE TB_ANAG_PRD00 SET\n  TREC = 'C',\n  LOWNER = 'user_5',\n  LDATA = '20250119140000'\nWHERE PRD_ID = 123;\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Record still exists"})," but filtered out from default queries (TREC != 'C')."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Documentation:"})," ",(0,s.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/entity-lifecycle",children:"Entity Lifecycle"})]}),"\n",(0,s.jsx)(n.h3,{id:"physical-delete-force",children:"Physical Delete (Force)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Endpoint:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DELETE /api/v4/core/{DIM}/{ID}?forceDelete=true\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Permanently remove record from database (irreversible)"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Request:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X DELETE "https://coreservice.q01.io/api/v4/core/PRD/123?source=productDelete&forceDelete=true" \\\n  -H "Authorization: Bearer eyJhbGc..."\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response (200 OK):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "code": 200,\n  "message": "Record permanently deleted",\n  "deletedId": "123"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What Happens:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"DELETE FROM TB_ANAG_PRD00 WHERE PRD_ID = 123;\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Warning:"})," Irreversible, no recovery, use sparingly."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Test data cleanup"}),"\n",(0,s.jsx)(n.li,{children:"GDPR compliance (right to be forgotten)"}),"\n",(0,s.jsx)(n.li,{children:"Data corruption fix"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"delete-with-cascades",children:"Delete with Cascades"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"If dimension has DELETE_CASCADE configured:"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"TB_COST Configuration:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- Order dimension has cascade to order items\nINSERT INTO TB_COST (DIM_COD, COD_COST, DELETE_CASCADE, ...)\nVALUES ('ORD', 'ORD_ID', 'ORDITEM:XORDITEM01', ...);\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Delete Order:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X DELETE "https://coreservice.q01.io/api/v4/core/ORD/555?source=orderDelete" \\\n  -H "Authorization: Bearer eyJhbGc..."\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Result:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- Parent soft deleted\nUPDATE TB_ANAG_ORD00 SET TREC = 'C' WHERE ORD_ID = 555;\n\n-- Children soft deleted (cascaded)\nUPDATE TB_ANAG_ORDITEM00 SET TREC = 'C' WHERE XORDITEM01 = 555;\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Both parent and children marked TREC='C', recoverable as unit."})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Documentation:"})," ",(0,s.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/cascades",children:"Cascade Operations"})]}),"\n",(0,s.jsx)(n.h2,{id:"field-visibility-and-cod_on_off",children:"Field Visibility and COD_ON_OFF"}),"\n",(0,s.jsx)(n.h3,{id:"creating-records-center_dettnuovo",children:"Creating Records (center_dett=nuovo)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Only fields with COD_ON_OFF containing 'N' can be set:"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"TB_COST:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"INSERT INTO TB_COST (COD_COST, COD_ON_OFF, ...)\nVALUES\n  ('XPRD01', 'L,D,N,M,R', ...),  -- \u2705 Can set on create (has N)\n  ('XPRD02', 'L,D,N,M', ...),    -- \u2705 Can set on create (has N)\n  ('XPRD15', 'L,D,M', ...); -- \u274c Cannot set on create (no N)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Request:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XPRD01": "Widget",\n  "XPRD02": 49.99,\n  "XPRD15": "secret",  // \u274c Will be rejected\n  "source": "productCreate"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response (400 Bad Request):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "code": 400,\n  "message": "Validation failed",\n  "errors": [\n    {\n      "field": "XPRD15",\n      "message": "Field not visible in \'nuovo\' context"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"updating-records-center_dettmodifica",children:"Updating Records (center_dett=modifica)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Only fields with COD_ON_OFF containing 'M' can be updated:"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Request:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH "https://coreservice.q01.io/api/v4/core/PRD/123" \\\n  -d \'{\n    "XPRD02": 59.99,           // \u2705 Has M in COD_ON_OFF\n    "XPRD16": "test",  // \u274c Has only L,D (no M)\n    "source": "productEdit"\n  }\'\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Result:"})," XPRD02 updated, XPRD16 rejected."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Documentation:"})," ",(0,s.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/field-visibility",children:"Field Visibility"})]}),"\n",(0,s.jsx)(n.h2,{id:"outbox-pattern-integration",children:"Outbox Pattern Integration"}),"\n",(0,s.jsx)(n.h3,{id:"every-write-operation-publishes-event",children:"Every Write Operation Publishes Event"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Create Event:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XOUTBOX04": "PRD",\n  "XOUTBOX05": "create",\n  "XOUTBOX06": "{\\"PRD_ID\\":\\"123\\",\\"XPRD01\\":\\"Widget\\"}",\n  "XOUTBOX10": 0  // Pending publish\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Update Event:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XOUTBOX04": "PRD",\n  "XOUTBOX05": "update",\n  "XOUTBOX06": "{\\"PRD_ID\\":\\"123\\",\\"XPRD02\\":59.99}",\n  "XOUTBOX10": 0\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Delete Event (Soft):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XOUTBOX04": "PRD",\n  "XOUTBOX05": "logicalDelete",\n  "XOUTBOX06": "{\\"PRD_ID\\":\\"123\\"}",\n  "XOUTBOX10": 0\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Relay Process:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Reads pending events (XOUTBOX10=0)"}),"\n",(0,s.jsx)(n.li,{children:"Publishes to RabbitMQ fanout exchange"}),"\n",(0,s.jsx)(n.li,{children:"Marks as published (XOUTBOX10=1)"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Guarantee:"})," At-least-once delivery to all subscribers."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Documentation:"})," ",(0,s.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/outbox-pattern",children:"Outbox Pattern"})]}),"\n",(0,s.jsx)(n.h2,{id:"practical-examples",children:"Practical Examples"}),"\n",(0,s.jsx)(n.h3,{id:"example-1-create-product-with-validation",children:"Example 1: Create Product with Validation"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Scenario:"})," Create product with auto-generated UUID and slug"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"async function createProduct(name, price, category) {\n  const response = await fetch('/api/v4/core/PRD', {\n    method: 'POST',\n    headers: {\n      'Authorization': `Bearer ${token}`,\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      XPRD01: name,\n      XPRD02: price,\n      XPRD05: category,\n      XPRD06: true,\n      source: 'productCreate'\n    })\n  });\n\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.message);\n  }\n\n  const result = await response.json();\n  return result[0].insertedId;\n}\n\n// Usage\ntry {\n  const productId = await createProduct('Premium Widget', 49.99, 'Electronics');\n  console.log(`Product created with ID: ${productId}`);\n} catch (error) {\n  console.error('Failed to create product:', error.message);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-2-update-product-price",children:"Example 2: Update Product Price"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Scenario:"})," Update only price field"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"async function updatePrice(productId, newPrice) {\n  const response = await fetch(`/api/v4/core/PRD/${productId}`, {\n    method: 'PATCH',\n    headers: {\n      'Authorization': `Bearer ${token}`,\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      XPRD02: newPrice,\n      source: 'productEdit'\n    })\n  });\n\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.message);\n  }\n\n  return response.json();\n}\n\n// Usage\nawait updatePrice(123, 59.99);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-3-soft-delete-with-recovery",children:"Example 3: Soft Delete with Recovery"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Delete:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X DELETE "https://coreservice.q01.io/api/v4/core/PRD/123?source=productDelete" \\\n  -H "Authorization: Bearer eyJhbGc..."\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Result:"})," TREC='C', not visible in lists."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Recover (Undelete):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X PATCH "https://coreservice.q01.io/api/v4/core/PRD/123" \\\n  -H "Authorization: Bearer eyJhbGc..." \\\n  -d \'{"TREC": "M", "source": "productEdit"}\'\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Result:"})," TREC='M', visible again."]}),"\n",(0,s.jsx)(n.h3,{id:"example-4-bulk-create-with-transaction",children:"Example 4: Bulk Create with Transaction"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"async function createProducts(products) {\n  const results = [];\n\n  for (const product of products) {\n    const response = await fetch('/api/v4/core/PRD', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        ...product,\n        source: 'productCreate'\n      })\n    });\n\n    const result = await response.json();\n    results.push(result[0].insertedId);\n  }\n\n  return results;\n}\n\n// Usage\nconst products = [\n  { XPRD01: 'Widget A', XPRD02: 29.99 },\n  { XPRD01: 'Widget B', XPRD02: 39.99 },\n  { XPRD01: 'Widget C', XPRD02: 49.99 }\n];\n\nconst ids = await createProducts(products);\nconsole.log('Created products:', ids);\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," Each request is independent transaction. For atomic bulk operations, use ",(0,s.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/batch-operations",children:"Batch Operations"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsx)(n.h3,{id:"common-error-patterns",children:"Common Error Patterns"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"1. Validation Error (400):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"try {\n  await fetch('/api/v4/core/PRD', {\n    method: 'POST',\n    body: JSON.stringify({ source: 'productCreate' })\n    // Missing required XPRD01\n  });\n} catch (error) {\n  // Handle: { code: 400, errors: [{field: \"XPRD01\", message: \"...\"}] }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"2. Permission Error (403):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"try {\n  await fetch('/api/v4/core/PRD', {\n    method: 'POST',\n    body: JSON.stringify({ XPRD01: 'Widget', source: 'productAdmin' })\n    // User lacks grant for productAdmin\n  });\n} catch (error) {\n  // Handle: { code: 403, message: \"Forbidden: insufficient permissions\" }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"3. Not Found (404):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"try {\n  await fetch('/api/v4/core/PRD/99999', {\n    method: 'PATCH',\n    body: JSON.stringify({ XPRD02: 59.99, source: 'productEdit' })\n    // Record doesn't exist\n  });\n} catch (error) {\n  // Handle: { code: 404, message: \"Record not found\" }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"4. Conflict (409):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"try {\n  await fetch('/api/v4/core/PRD', {\n    method: 'POST',\n    body: JSON.stringify({\n      XPRD03: 'WDG-2025-001',  // Unique code already exists\n      source: 'productCreate'\n    })\n  });\n} catch (error) {\n  // Handle: { code: 409, message: \"Duplicate key violation\" }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"-do-use-patch-for-updates",children:"\u2705 DO: Use PATCH for Updates"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Preferred:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Only send changed fields\nawait fetch(`/api/v4/core/PRD/${id}`, {\n  method: 'PATCH',\n  body: JSON.stringify({ XPRD02: 59.99, source: 'productEdit' })\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Avoid:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Must send all fields, risk losing data\nawait fetch(`/api/v4/core/PRD/${id}`, {\n  method: 'PUT',\n  body: JSON.stringify({ XPRD01: '...', XPRD02: 59.99, ... })\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"-do-use-soft-delete-by-default",children:"\u2705 DO: Use Soft Delete by Default"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Preferred:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"DELETE /api/v4/core/PRD/123?source=productDelete\n# TREC='C', recoverable\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Avoid:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"DELETE /api/v4/core/PRD/123?source=productDelete&forceDelete=true\n# Permanent deletion, irreversible\n"})}),"\n",(0,s.jsx)(n.h3,{id:"-do-validate-before-sending",children:"\u2705 DO: Validate Before Sending"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Client-side validation:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"function validateProduct(product) {\n  const errors = [];\n\n  if (!product.XPRD01 || product.XPRD01.trim() === '') {\n    errors.push({ field: 'XPRD01', message: 'Name is required' });\n  }\n\n  if (!product.XPRD02 || product.XPRD02 <= 0) {\n    errors.push({ field: 'XPRD02', message: 'Price must be positive' });\n  }\n\n  return errors;\n}\n\nconst errors = validateProduct(product);\nif (errors.length > 0) {\n  // Show errors to user, don't send request\n  return;\n}\n\n// Send request\nawait createProduct(product);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"-do-handle-errors-gracefully",children:"\u2705 DO: Handle Errors Gracefully"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"async function createProduct(data) {\n  try {\n    const response = await fetch('/api/v4/core/PRD', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({ ...data, source: 'productCreate' })\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n\n      if (error.code === 400) {\n        // Validation errors - show to user\n        showValidationErrors(error.errors);\n      } else if (error.code === 403) {\n        // Permission error - show message\n        showError('You do not have permission to create products');\n      } else {\n        // Generic error\n        showError('Failed to create product. Please try again.');\n      }\n\n      return null;\n    }\n\n    const result = await response.json();\n    return result[0].insertedId;\n  } catch (error) {\n    // Network error\n    showError('Network error. Please check your connection.');\n    return null;\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"-dont-send-fields-not-visible-in-context",children:"\u274c DON'T: Send Fields Not Visible in Context"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Wrong:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XPRD01": "Widget",\n  "XPRD17": "secret",  // COD_ON_OFF=\'L,D\' (no N)\n  "source": "productCreate"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Right:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XPRD01": "Widget",\n  "XPRD02": 49.99,  // Only fields with N in COD_ON_OFF\n  "source": "productCreate"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"-dont-manually-set-audit-fields",children:"\u274c DON'T: Manually Set Audit Fields"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Wrong:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XPRD01": "Widget",\n  "OWNER": "user_99",  // Manual override\n  "CDATA": "20250101000000",\n  "TREC": "N",\n  "source": "productCreate"\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Why:"})," OWNER, CDATA, LOWNER, LDATA, TREC are auto-populated by CoreWrite. Manual values ignored or cause errors."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Right:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "XPRD01": "Widget",\n  "XPRD02": 49.99,\n  "source": "productCreate"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"-dont-use-forcedelete-without-confirmation",children:"\u274c DON'T: Use forceDelete Without Confirmation"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Wrong:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Deletes permanently without user confirmation\nawait fetch(`/api/v4/core/PRD/${id}?source=productDelete&forceDelete=true`, {\n  method: 'DELETE'\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Right:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Confirm before permanent deletion\nif (confirm('Permanently delete this product? This cannot be undone.')) {\n  await fetch(`/api/v4/core/PRD/${id}?source=productDelete&forceDelete=true`, {\n    method: 'DELETE'\n  });\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Write Operations"})," provide:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Full CRUD capabilities"})," - Create, update, delete with one request"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Automatic field population"})," - Pre-insert functions, audit fields, TREC"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Transaction guarantees"})," - ACID compliance, rollback on error"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Cascade support"})," - Automatic propagation to related records"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Event publishing"})," - Outbox pattern for eventual consistency"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Multi-level validation"})," - Permissions, required fields, COD_ON_OFF"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Insight:"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Write operations are more than database INSERTs/UPDATEs/DELETEs - they're orchestrated transactions that validate, transform, cascade, and publish events, all while maintaining ACID guarantees and audit trails."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Next Steps:"})}),"\n",(0,s.jsxs)(n.p,{children:["Continue to ",(0,s.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/field-metadata",children:"Field Metadata \u2192"})," to learn how to retrieve field definitions for dynamic forms."]})]})}function h(e={}){const{wrapper:n}={...(0,i.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},2172:(e,n,r)=>{r.d(n,{I:()=>o,M:()=>d});var s=r(1504);const i={},t=s.createContext(i);function d(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);