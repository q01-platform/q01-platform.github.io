"use strict";(self.webpackChunkq_01_docs=self.webpackChunkq_01_docs||[]).push([[7612],{1008:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>t,metadata:()=>c,toc:()=>l});var r=s(7624),i=s(2172);const t={title:"Source Parameter",sidebar_label:"13. Source Parameter",sidebar_position:14,description:"Understanding the source parameter - the critical link between menu permissions and data access"},o="Source Parameter",c={id:"products/map.q01.io/core-api-platform-v4/core-concepts/source-parameter",title:"Source Parameter",description:"Understanding the source parameter - the critical link between menu permissions and data access",source:"@site/docs/products/map.q01.io/core-api-platform-v4/01-core-concepts/source-parameter.md",sourceDirName:"products/map.q01.io/core-api-platform-v4/01-core-concepts",slug:"/products/map.q01.io/core-api-platform-v4/core-concepts/source-parameter",permalink:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/source-parameter",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:14,frontMatter:{title:"Source Parameter",sidebar_label:"13. Source Parameter",sidebar_position:14,description:"Understanding the source parameter - the critical link between menu permissions and data access"},sidebar:"mapSidebar",previous:{title:"12. Counter Management",permalink:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/counter-management"},next:{title:"API Operations",permalink:"/docs/products/map.q01.io/core-api-platform-v4/api-operations/"}},a={},l=[{value:"Overview",id:"overview",level:2},{value:"What is the Source Parameter?",id:"what-is-the-source-parameter",level:2},{value:"How Source Works",id:"how-source-works",level:2},{value:"Permission to Dimension Binding",id:"permission-to-dimension-binding",level:3},{value:"Menu Structure Example",id:"menu-structure-example",level:3},{value:"Required in All API Calls",id:"required-in-all-api-calls",level:2},{value:"Query Parameter (GET Requests)",id:"query-parameter-get-requests",level:3},{value:"Request Body (POST/PUT/PATCH Requests)",id:"request-body-postputpatch-requests",level:3},{value:"DELETE Requests",id:"delete-requests",level:3},{value:"Validation and Errors",id:"validation-and-errors",level:2},{value:"Missing Source Parameter",id:"missing-source-parameter",level:3},{value:"Invalid Source Value",id:"invalid-source-value",level:3},{value:"Source-Dimension Mismatch",id:"source-dimension-mismatch",level:3},{value:"How Source is Generated",id:"how-source-is-generated",level:2},{value:"Step 1: Create Menu Item in TB_MENU",id:"step-1-create-menu-item-in-tb_menu",level:3},{value:"Step 2: Assign Grants to Users",id:"step-2-assign-grants-to-users",level:3},{value:"Step 3: Use in API Calls",id:"step-3-use-in-api-calls",level:3},{value:"Why Source Matters",id:"why-source-matters",level:2},{value:"1. Security and Multi-Tenant Isolation",id:"1-security-and-multi-tenant-isolation",level:3},{value:"2. Permission Context",id:"2-permission-context",level:3},{value:"3. Field Visibility Control",id:"3-field-visibility-control",level:3},{value:"Source in Different Operations",id:"source-in-different-operations",level:2},{value:"Read Operations",id:"read-operations",level:3},{value:"Write Operations",id:"write-operations",level:3},{value:"Special Operations",id:"special-operations",level:3},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Pattern 1: Module-Specific Sources",id:"pattern-1-module-specific-sources",level:3},{value:"Pattern 2: Multi-Tenant Sources",id:"pattern-2-multi-tenant-sources",level:3},{value:"Pattern 3: Environment-Specific Sources",id:"pattern-3-environment-specific-sources",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"\u2705 DO:",id:"-do",level:3},{value:"\u274c DON&#39;T:",id:"-dont",level:3},{value:"Integration with Other Concepts",id:"integration-with-other-concepts",level:2},{value:"Source + Context Chain",id:"source--context-chain",level:3},{value:"Source + Nested Set Permissions",id:"source--nested-set-permissions",level:3},{value:"Source + COD_ON_OFF",id:"source--cod_on_off",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Problem: &quot;Invalid DIM from provided source&quot;",id:"problem-invalid-dim-from-provided-source",level:3},{value:"Problem: &quot;Missing required parameter: source&quot;",id:"problem-missing-required-parameter-source",level:3},{value:"Problem: 403 Forbidden with valid source",id:"problem-403-forbidden-with-valid-source",level:3},{value:"Summary",id:"summary",level:2},{value:"Related Concepts",id:"related-concepts",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"source-parameter",children:"Source Parameter"}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"source parameter"})," is a required identifier that appears in every Core API request. It links menu-based permissions (TB_MENU) to dimension access (TB_DIM), enabling the platform to determine which data the authenticated user can access."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Critical Importance:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Required in ALL API calls"})," - no exceptions"]}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Links permission hierarchy to data access"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Enables multi-tenant isolation"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Validates dimension access rights"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Determines field visibility context"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example Values:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"settings-2"'})," - Settings module, menu item 2"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"sc-4"'})," - Scorecard module, menu item 4"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"inventory-1"'})," - Inventory module, menu item 1"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"sales-orders-3"'})," - Sales orders module, menu item 3"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"what-is-the-source-parameter",children:"What is the Source Parameter?"}),"\n",(0,r.jsxs)(n.p,{children:["The source parameter is a ",(0,r.jsx)(n.strong,{children:"business logic identifier"})," that combines:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Microservice/Module Prefix"})," - identifies the application area"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Numerical Suffix"})," - identifies specific menu item"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Format:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"{microservice_prefix}-{menu_number}\n\nExamples:\n- settings-2\n- sc-4\n- inventory-1\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Storage and Generation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Stored in ",(0,r.jsx)(n.code,{children:"TB_MENU.COD_MENU"})," field"]}),"\n",(0,r.jsx)(n.li,{children:"Generated when creating menu items in the platform"}),"\n",(0,r.jsx)(n.li,{children:"Links to dimension permissions via business logic"}),"\n",(0,r.jsx)(n.li,{children:"Unique within the permission hierarchy"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"how-source-works",children:"How Source Works"}),"\n",(0,r.jsx)(n.h3,{id:"permission-to-dimension-binding",children:"Permission to Dimension Binding"}),"\n",(0,r.jsx)(n.p,{children:"The source parameter creates a critical link in the permission chain:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"User Authentication\n    \u2193\nJWT Token (includes grants)\n    \u2193\nAPI Request (includes source parameter)\n    \u2193\nTB_MENU lookup (COD_MENU = source)\n    \u2193\nBusiness Logic (resolve dimension from menu context)\n    \u2193\nTB_DIM validation (user can access this dimension?)\n    \u2193\nGrant Check (user has permission for this operation?)\n    \u2193\nData Access\n"})}),"\n",(0,r.jsx)(n.h3,{id:"menu-structure-example",children:"Menu Structure Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- TB_MENU example\nCOD_MENU        DESCRIZIONE              NLEFT  NRIGHT  COD_DIM_MENU\n-----------------------------------------------------------------\nsettings-1      Settings Root            1      20      NULL\nsettings-2      Product Catalog          2      9       ART\nsettings-3      Price Lists              10     13      LST\nsettings-4      Departments              14     19      DEPFOOD\n\n-- When user calls: GET /api/v4/core/ART?source=settings-2\n-- Platform resolves: COD_MENU='settings-2' \u2192 COD_DIM_MENU='ART'\n-- Validates: User has grant for settings-2 in nested set?\n-- Result: Access granted or denied based on TB_MENU hierarchy\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"required-in-all-api-calls",children:"Required in All API Calls"}),"\n",(0,r.jsxs)(n.p,{children:["The source parameter must be included in ",(0,r.jsx)(n.strong,{children:"every Core API request"}),", either as:"]}),"\n",(0,r.jsx)(n.h3,{id:"query-parameter-get-requests",children:"Query Parameter (GET Requests)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# List products\nGET /api/v4/core/ART?source=settings-2\n\n# Get single product\nGET /api/v4/core/ART/123?source=settings-2\n\n# Filter products\nGET /api/v4/core/ART?source=settings-2&filter[XART06]=1\n\n# Count products\nGET /api/v4/core/ART/count?source=settings-2\n"})}),"\n",(0,r.jsx)(n.h3,{id:"request-body-postputpatch-requests",children:"Request Body (POST/PUT/PATCH Requests)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'// Create product\nPOST /api/v4/core/ART\n{\n  "source": "settings-2",\n  "data": {\n    "XART01": "2",\n    "XART20": "Widget Pro"\n  }\n}\n\n// Update product\nPUT /api/v4/core/ART/123\n{\n  "source": "settings-2",\n  "data": {\n    "XART20": "Widget Pro Updated"\n  }\n}\n\n// Partial update\nPATCH /api/v4/core/ART/123\n{\n  "source": "settings-2",\n  "data": {\n    "XART06": 1\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"delete-requests",children:"DELETE Requests"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Soft delete\nDELETE /api/v4/core/ART/123?source=settings-2\n\n# Force delete\nDELETE /api/v4/core/ART/123?source=settings-2&force=true\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"validation-and-errors",children:"Validation and Errors"}),"\n",(0,r.jsx)(n.h3,{id:"missing-source-parameter",children:"Missing Source Parameter"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/core/ART\n# Missing source parameter\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": 400,\n  "message": "Missing required parameter: source",\n  "code": "MISSING_SOURCE"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"invalid-source-value",children:"Invalid Source Value"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/core/ART?source=invalid-menu-999\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": 400,\n  "message": "Invalid DIM from provided source",\n  "code": "INVALID_SOURCE",\n  "details": "Source \'invalid-menu-999\' does not exist in TB_MENU or does not map to dimension ART"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"source-dimension-mismatch",children:"Source-Dimension Mismatch"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# source=settings-2 maps to ART dimension\nGET /api/v4/core/ORD?source=settings-2\n# Requesting ORD dimension with ART source\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": 400,\n  "message": "Invalid DIM from provided source",\n  "code": "SOURCE_DIM_MISMATCH",\n  "details": "Source \'settings-2\' is configured for dimension ART, not ORD"\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"how-source-is-generated",children:"How Source is Generated"}),"\n",(0,r.jsx)(n.p,{children:"The source parameter is created when menu items are configured in the platform:"}),"\n",(0,r.jsx)(n.h3,{id:"step-1-create-menu-item-in-tb_menu",children:"Step 1: Create Menu Item in TB_MENU"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INSERT INTO TB_MENU (\n    COD_MENU,              -- Auto-generated: {prefix}-{number}\n    DESCRIZIONE,           -- \"Product Catalog\"\n    COD_DIM_MENU,          -- \"ART\" (dimension this menu accesses)\n    NLEFT,                 -- Nested set left boundary\n    NRIGHT,                -- Nested set right boundary\n    PARENT_MENU            -- Parent menu code\n) VALUES (\n    'settings-2',          -- Generated source value\n    'Product Catalog',\n    'ART',\n    2,\n    9,\n    'settings-1'\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-2-assign-grants-to-users",children:"Step 2: Assign Grants to Users"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Grant user access to settings-2 menu\nINSERT INTO TB_GRANTS (\n    USER_ID,\n    COD_MENU,\n    GRANT_TYPE\n) VALUES (\n    'user123',\n    'settings-2',\n    'READ_WRITE'\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-3-use-in-api-calls",children:"Step 3: Use in API Calls"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# User can now access ART dimension via source=settings-2\nGET /api/v4/core/ART?source=settings-2\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"why-source-matters",children:"Why Source Matters"}),"\n",(0,r.jsx)(n.h3,{id:"1-security-and-multi-tenant-isolation",children:"1. Security and Multi-Tenant Isolation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Problem without source:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Without source, all users could access any dimension\nGET /api/v4/core/ART\n# How does platform know which tenant's data?\n# How does platform check permissions?\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solution with source:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/core/ART?source=settings-2\n# Platform resolves: settings-2 \u2192 ART dimension\n# Platform checks: User has grant for settings-2?\n# Platform filters: Only tenant data for this user\n# Result: Secure, multi-tenant data access\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-permission-context",children:"2. Permission Context"}),"\n",(0,r.jsxs)(n.p,{children:["The source parameter provides the ",(0,r.jsx)(n.strong,{children:"permission context"})," for the request:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'source = "settings-2"\n    \u2193\nTB_MENU lookup\n    \u2193\nNested Set position (NLEFT=2, NRIGHT=9)\n    \u2193\nUser Grant Check\n    \u2193\nParent/Child permission inheritance\n    \u2193\nOperation allowed/denied\n'})}),"\n",(0,r.jsx)(n.h3,{id:"3-field-visibility-control",children:"3. Field Visibility Control"}),"\n",(0,r.jsxs)(n.p,{children:["Source parameter contributes to the ",(0,r.jsx)(n.strong,{children:"context chain"})," that determines field visibility:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// Context chain\n{\n  source: "settings-2",        // Permission context\n  peso: 3,                      // User level\n  ambiente: "P",                // Environment\n  centro_dett: "visualizza",    // View mode\n  modulo: "inventory",          // Module\n  lingua: "IT"                  // Language\n}\n\n// Together determine which fields are visible via COD_ON_OFF\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"source-in-different-operations",children:"Source in Different Operations"}),"\n",(0,r.jsx)(n.h3,{id:"read-operations",children:"Read Operations"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"List Records:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/core/ART?source=settings-2&$num_rows=100\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Get Single Record:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/core/ART/123?source=settings-2\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Get Field Metadata:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/core/ART/fields?source=settings-2\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Count Records:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/core/ART/count?source=settings-2\n"})}),"\n",(0,r.jsx)(n.h3,{id:"write-operations",children:"Write Operations"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Create Record:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'POST /api/v4/core/ART\n{\n  "source": "settings-2",\n  "data": { ... }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Update Record:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'PUT /api/v4/core/ART/123\n{\n  "source": "settings-2",\n  "data": { ... }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Partial Update:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'PATCH /api/v4/core/ART/123\n{\n  "source": "settings-2",\n  "data": { ... }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Delete Record:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"DELETE /api/v4/core/ART/123?source=settings-2\n"})}),"\n",(0,r.jsx)(n.h3,{id:"special-operations",children:"Special Operations"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"AC/VARS Queries:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/core/vars?source=settings-2&field=XART11\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Document Queries:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/document/SHORT_ARTICLE_INFO/055570?source=settings-2\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Media Upload:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"POST /api/v4/media/upload?source=settings-2\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"pattern-1-module-specific-sources",children:"Pattern 1: Module-Specific Sources"}),"\n",(0,r.jsx)(n.p,{children:"Organize sources by application module:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Inventory module\ninventory-1    \u2192 Stock Management\ninventory-2    \u2192 Warehouse Locations\ninventory-3    \u2192 Stock Movements\n\n-- Sales module\nsales-1        \u2192 Orders\nsales-2        \u2192 Invoices\nsales-3        \u2192 Quotes\n\n-- Customer module\ncustomers-1    \u2192 Customer List\ncustomers-2    \u2192 Customer Addresses\ncustomers-3    \u2192 Customer Contacts\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pattern-2-multi-tenant-sources",children:"Pattern 2: Multi-Tenant Sources"}),"\n",(0,r.jsx)(n.p,{children:"Different tenants use different source prefixes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Tenant A (retail company)\nretail-1       \u2192 Products (COD_DIM=ART, Tenant=A)\nretail-2       \u2192 Orders (COD_DIM=ORD, Tenant=A)\n\n-- Tenant B (wholesale company)\nwholesale-1    \u2192 Products (COD_DIM=ART, Tenant=B)\nwholesale-2    \u2192 Orders (COD_DIM=ORD, Tenant=B)\n\n-- Same dimension (ART), different tenants, different sources\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pattern-3-environment-specific-sources",children:"Pattern 3: Environment-Specific Sources"}),"\n",(0,r.jsx)(n.p,{children:"Development vs production use different sources:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Development\ndev-settings-2  \u2192 ART dimension (development data)\n\n-- Production\nprod-settings-2 \u2192 ART dimension (production data)\n\n-- Controlled via ambiente in context chain\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"-do",children:"\u2705 DO:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Always include source:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Good - source provided\nGET /api/v4/core/ART?source=settings-2\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use correct source for dimension:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Good - settings-2 maps to ART\nGET /api/v4/core/ART?source=settings-2\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Store source in client configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 Good - centralized source management\nconst API_CONFIG = {\n  products: 'settings-2',\n  orders: 'sales-1',\n  customers: 'customers-1'\n};\n\nconst products = await fetch(\n  `/api/v4/core/ART?source=${API_CONFIG.products}`\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"-dont",children:"\u274c DON'T:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't omit source:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c Bad - missing source\nGET /api/v4/core/ART\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't hardcode source values:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Bad - hardcoded source\nconst products = await fetch('/api/v4/core/ART?source=settings-2');\n\n// \u2705 Good - configurable source\nconst products = await fetch(`/api/v4/core/ART?source=${config.productSource}`);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't use wrong source for dimension:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c Bad - sales-1 maps to ORD, not ART\nGET /api/v4/core/ART?source=sales-1\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"integration-with-other-concepts",children:"Integration with Other Concepts"}),"\n",(0,r.jsx)(n.h3,{id:"source--context-chain",children:"Source + Context Chain"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// Complete context for API request\n{\n  source: "settings-2",        // Permission context (TB_MENU)\n  peso: 3,                      // User level (1-5)\n  ambiente: "P",                // Environment (P/T/S)\n  centro_dett: "visualizza",    // View mode\n  modulo: "inventory",          // Module\n  lingua: "IT"                  // Language\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"source--nested-set-permissions",children:"Source + Nested Set Permissions"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- User has grant for parent menu\nCOD_MENU = 'settings-1' (NLEFT=1, NRIGHT=20)\n\n-- Child menus inherit permission\nsettings-2 (NLEFT=2, NRIGHT=9) \u2192 GRANTED (2 between 1 and 20)\nsettings-3 (NLEFT=10, NRIGHT=13) \u2192 GRANTED (10 between 1 and 20)\n\n-- Source parameter enables nested set check\n"})}),"\n",(0,r.jsx)(n.h3,{id:"source--cod_on_off",children:"Source + COD_ON_OFF"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Source determines permission context\n-- centro_dett determines view mode\n-- Together they select appropriate COD_ON_OFF flags\n\nsource=settings-2 + centro_dett=visualizza \u2192 fields with L flag\nsource=settings-2 + centro_dett=dettaglio  \u2192 fields with D flag\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"problem-invalid-dim-from-provided-source",children:'Problem: "Invalid DIM from provided source"'}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause:"})," Source parameter doesn't map to the requested dimension."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Check TB_MENU for correct COD_MENU value"}),"\n",(0,r.jsx)(n.li,{children:"Verify COD_DIM_MENU matches requested dimension"}),"\n",(0,r.jsx)(n.li,{children:"Use correct source for the dimension you're accessing"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"problem-missing-required-parameter-source",children:'Problem: "Missing required parameter: source"'}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause:"})," Source parameter not included in request."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Add source to query string (GET)"}),"\n",(0,r.jsx)(n.li,{children:"Add source to request body (POST/PUT/PATCH/DELETE)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"problem-403-forbidden-with-valid-source",children:"Problem: 403 Forbidden with valid source"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cause:"})," User doesn't have grant for the specified source."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Check user's grants in TB_GRANTS"}),"\n",(0,r.jsx)(n.li,{children:"Verify nested set hierarchy in TB_MENU"}),"\n",(0,r.jsx)(n.li,{children:"Ensure user has permission for source menu item"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 Source parameter is ",(0,r.jsx)(n.strong,{children:"required in ALL API calls"})]}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Links TB_MENU (permissions) \u2192 TB_DIM (data access)"}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 Format: ",(0,r.jsx)(n.code,{children:"{microservice_prefix}-{menu_number}"})]}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Enables multi-tenant isolation and security"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Validates dimension access rights"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Contributes to context chain for field visibility"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Generated when creating menu items in TB_MENU"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Missing or invalid source \u2192 400 Bad Request error"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Takeaways:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Never omit the source parameter - it's mandatory"}),"\n",(0,r.jsx)(n.li,{children:"Use the correct source for the dimension you're accessing"}),"\n",(0,r.jsx)(n.li,{children:"Store source values in configuration, not hardcoded"}),"\n",(0,r.jsx)(n.li,{children:"Source is the bridge between permissions and data"}),"\n",(0,r.jsx)(n.li,{children:"Validates via TB_MENU \u2192 COD_DIM_MENU mapping"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-concepts",children:"Related Concepts"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/nested-set-model",children:"Nested Set Model"})," - TB_MENU hierarchical permissions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/context-chain",children:"Context Chain"})," - Complete request context"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/permissions",children:"Multi-Level Permissions"})," - Layered authorization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/reference/metadata-tables#tb_menu---permission-hierarchy",children:"TB_MENU"})," - Menu metadata table"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/core-concepts/permissions",children:"Grants"})," - Permission assignment"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},2172:(e,n,s)=>{s.d(n,{I:()=>c,M:()=>o});var r=s(1504);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);