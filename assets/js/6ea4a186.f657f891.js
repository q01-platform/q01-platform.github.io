"use strict";(self.webpackChunkq_01_docs=self.webpackChunkq_01_docs||[]).push([[9588],{7740:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>c,toc:()=>a});var r=s(7624),i=s(2172);const d={title:"Document Queries",sidebar_label:"Document Queries",sidebar_position:12,description:"Advanced multi-table aggregation queries with the Document API"},l="Document Queries",c={id:"products/map.q01.io/core-api-platform-v4/query-patterns/document-queries",title:"Document Queries",description:"Advanced multi-table aggregation queries with the Document API",source:"@site/docs/products/map.q01.io/core-api-platform-v4/03-query-patterns/document-queries.md",sourceDirName:"products/map.q01.io/core-api-platform-v4/03-query-patterns",slug:"/products/map.q01.io/core-api-platform-v4/query-patterns/document-queries",permalink:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/document-queries",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:12,frontMatter:{title:"Document Queries",sidebar_label:"Document Queries",sidebar_position:12,description:"Advanced multi-table aggregation queries with the Document API"},sidebar:"mapSidebar",previous:{title:"Query Performance",permalink:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/query-performance"},next:{title:"AC/VARS Queries",permalink:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/ac-vars-queries"}},t={},a=[{value:"Overview",id:"overview",level:2},{value:"Pre-Defined Documents",id:"pre-defined-documents",level:2},{value:"Document Definition Structure",id:"document-definition-structure",level:3},{value:"Aggregate Dim JSON Format",id:"aggregate-dim-json-format",level:3},{value:"Aggregate Dim Conditions JSON",id:"aggregate-dim-conditions-json",level:3},{value:"Querying Pre-Defined Documents",id:"querying-pre-defined-documents",level:2},{value:"Endpoint",id:"endpoint",level:3},{value:"Example: SHORT_ARTICLE_INFO Document",id:"example-short_article_info-document",level:3},{value:"On-the-Fly Documents",id:"on-the-fly-documents",level:2},{value:"Endpoint",id:"endpoint-1",level:3},{value:"Request Body Structure",id:"request-body-structure",level:3},{value:"Example: Full Article Info On-the-Fly",id:"example-full-article-info-on-the-fly",level:3},{value:"Advanced Parameters",id:"advanced-parameters",level:2},{value:"depth",id:"depth",level:3},{value:"dim_occurrences",id:"dim_occurrences",level:3},{value:"compact",id:"compact",level:3},{value:"use_public_code",id:"use_public_code",level:3},{value:"markers",id:"markers",level:3},{value:"center_dett",id:"center_dett",level:3},{value:"debug",id:"debug",level:3},{value:"Pagination",id:"pagination",level:3},{value:"Use Cases",id:"use-cases",level:2},{value:"Use Case 1: Product Detail Page",id:"use-case-1-product-detail-page",level:3},{value:"Use Case 2: Order Management",id:"use-case-2-order-management",level:3},{value:"Use Case 3: Data Export for Seeding",id:"use-case-3-data-export-for-seeding",level:3},{value:"Use Case 4: Mobile App Offline Sync",id:"use-case-4-mobile-app-offline-sync",level:3},{value:"When to Use Document API vs Regular Queries",id:"when-to-use-document-api-vs-regular-queries",level:2},{value:"Use Document API When:",id:"use-document-api-when",level:3},{value:"Use Regular Queries When:",id:"use-regular-queries-when",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"\u2705 DO:",id:"-do",level:3},{value:"\u274c DON&#39;T:",id:"-dont",level:3},{value:"Common Errors",id:"common-errors",level:2},{value:"Error: Missing Token Parameter",id:"error-missing-token-parameter",level:3},{value:"Error: Invalid Dimension in related_dim",id:"error-invalid-dimension-in-related_dim",level:3},{value:"Summary",id:"summary",level:2},{value:"Related Concepts",id:"related-concepts",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"document-queries",children:"Document Queries"}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"Document API"})," provides a powerful mechanism for retrieving coherent blocks of data from multiple related dimensions in a single API call. Instead of making separate requests for a master record and its related records, Document Queries aggregate everything into one structured response."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Benefits:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Single API call retrieves master + related dimensions"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Metadata-driven relationships (no hardcoded joins)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Coherent data (all records in consistent state)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Flexible field selection (include/exclude specific fields)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Dynamic filtering via token-based parameters"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Support for nested recursion with depth control"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Product with all barcodes, price lists, and inventory"}),"\n",(0,r.jsx)(n.li,{children:"Order with all line items, payments, and shipping info"}),"\n",(0,r.jsx)(n.li,{children:"Customer with all addresses, contacts, and purchase history"}),"\n",(0,r.jsx)(n.li,{children:"Invoice with all line items, taxes, and payment details"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"pre-defined-documents",children:"Pre-Defined Documents"}),"\n",(0,r.jsxs)(n.p,{children:["Pre-defined documents are stored in the ",(0,r.jsx)(n.code,{children:"TB_ANAG_DOCDIM00"})," metadata table and can be reused across the application."]}),"\n",(0,r.jsx)(n.h3,{id:"document-definition-structure",children:"Document Definition Structure"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Required Fields:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Example"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"COD_DOCDIM"})}),(0,r.jsx)(n.td,{children:"Unique document identifier"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"SHORT_ARTICLE_INFO"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Description"})}),(0,r.jsx)(n.td,{children:"Document description"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Article with select fields from BCODE and LST"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Source Dim"})}),(0,r.jsx)(n.td,{children:"Master dimension to query"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"ART"})," (Articles)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Key Source Dim"})}),(0,r.jsx)(n.td,{children:"Field used to filter master records"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"XART03"})," (Article Code)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Aggregate Dim"})}),(0,r.jsx)(n.td,{children:"JSON: which related dimensions to include"}),(0,r.jsx)(n.td,{children:"See below"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Aggregate Dim Conditions"})}),(0,r.jsx)(n.td,{children:"JSON: filtering on related dimensions"}),(0,r.jsx)(n.td,{children:"See below"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Microservice"})}),(0,r.jsx)(n.td,{children:"Owning microservice"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mssettings"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Module"})}),(0,r.jsx)(n.td,{children:"Application module"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"inventory"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Public"})}),(0,r.jsx)(n.td,{children:"Public (1) or private (0)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"1"})})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"aggregate-dim-json-format",children:"Aggregate Dim JSON Format"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"Aggregate Dim"})," field defines which related dimensions to include and which fields from each dimension."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Include Specific Fields:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "BCODE": ["XBCODE03", "XBCODE04"],\n  "LST": ["XLST10", "XLST13", "XLST14", "XLST15"]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Exclude Specific Fields (! prefix):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "BCODE": ["XBCODE03"],\n  "LST": ["!LST_ID", "!OWNER", "!CDATA"]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Returns all LST fields EXCEPT LST_ID, OWNER, CDATA."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Empty Object = All Related Dimensions:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:"{}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Returns ALL related dimensions defined in metadata (TB_OBJECT)."}),"\n",(0,r.jsx)(n.h3,{id:"aggregate-dim-conditions-json",children:"Aggregate Dim Conditions JSON"}),"\n",(0,r.jsxs)(n.p,{children:["Dynamic filtering on related dimensions using ",(0,r.jsx)(n.strong,{children:"token-based parameters"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "LST": [\n    "XLST03 = \'%codLst%\'",\n    "XLST25 = \'%areaListino%\'"\n  ]\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Token Format:"})," ",(0,r.jsx)(n.code,{children:"%tokenName%"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Tokens are replaced with actual values from query parameters"}),"\n",(0,r.jsxs)(n.li,{children:["Tokens are ",(0,r.jsx)(n.strong,{children:"required"})," - request fails if missing"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"querying-pre-defined-documents",children:"Querying Pre-Defined Documents"}),"\n",(0,r.jsx)(n.h3,{id:"endpoint",children:"Endpoint"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/document/{COD_DOCDIM}/{key_value}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{COD_DOCDIM}"})," - Document code from TB_ANAG_DOCDIM00"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"{key_value}"})," - Value to filter master dimension by Key Source Dim field"]}),"\n",(0,r.jsx)(n.li,{children:"Token parameters (required if document definition includes tokens)"}),"\n",(0,r.jsx)(n.li,{children:"Optional parameters (depth, compact, use_public_code, markers, etc.)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-short_article_info-document",children:"Example: SHORT_ARTICLE_INFO Document"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Document Definition:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"COD_DOCDIM:"})," ",(0,r.jsx)(n.code,{children:"SHORT_ARTICLE_INFO"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Source Dim:"})," ",(0,r.jsx)(n.code,{children:"ART"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Key Source Dim:"})," ",(0,r.jsx)(n.code,{children:"XART03"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Aggregate Dim:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "BCODE": ["XBCODE03"],\n  "LST": ["XLST10", "XLST13", "XLST14", "XLST15"]\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Aggregate Dim Conditions:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "LST": [\n    "XLST03 = \'%codLst%\'",\n    "XLST25 = \'%areaListino%\'"\n  ]\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/document/SHORT_ARTICLE_INFO/300100?codLst=1&areaListino=ITA\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "ART_ID": 1234,\n    "OWNER": "SYS",\n    "CDATA": "20200301082500",\n    "TREC": "N",\n    "XART01": "2",\n    "XART03": "055570",\n    "XART20": "Spaghetti alla carbonara",\n    "XART25": "9.00",\n    "XART53": "rep1",\n    "XART57": [\n      {\n        "XBCODE03": "05595012"\n      }\n    ],\n    "XART58": [\n      {\n        "XLST10": 9.00,\n        "XLST13": 10.99,\n        "XLST14": 10.99,\n        "XLST15": 12.99\n      }\n    ]\n  }\n]\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Related dimensions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"XART57"})," = BCODE records (barcodes)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"XART58"})," = LST records (price lists filtered by codLst=1 and areaListino=ITA)"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"on-the-fly-documents",children:"On-the-Fly Documents"}),"\n",(0,r.jsx)(n.p,{children:"Generate documents dynamically without pre-defining them in TB_ANAG_DOCDIM00."}),"\n",(0,r.jsx)(n.h3,{id:"endpoint-1",children:"Endpoint"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"POST /api/v4/document\n"})}),"\n",(0,r.jsx)(n.h3,{id:"request-body-structure",children:"Request Body Structure"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Single Key:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "dim": "ART",\n  "val_key": "055570",\n  "related_dim": {\n    "BCODE": ["XBCODE03"],\n    "LST": ["XLST10", "XLST13"]\n  },\n  "related_dim_condition": {\n    "LST": ["XLST03 = \'1\'", "XLST25 = \'ITA\'"]\n  },\n  "compact": true,\n  "use_public_code": false,\n  "center_dett": "allviews"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Multiple Keys:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "dim": "ART",\n  "list_val_keys": ["055570", "055571", "055572"],\n  "related_dim": { ... },\n  "compact": false\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Filter-Based:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "dim": "ART",\n  "filter_val_key": "contains(XART20,\'pasta\') OR equals(XART03,\'534508\')",\n  "related_dim": { ... },\n  "$offset": 0,\n  "$num_rows": 25\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"example-full-article-info-on-the-fly",children:"Example: Full Article Info On-the-Fly"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'POST /api/v4/document\n{\n  "dim": "ART",\n  "val_key": "055570",\n  "related_dim": {},\n  "compact": false,\n  "use_public_code": false,\n  "center_dett": "allviews",\n  "markers": 0\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Empty ",(0,r.jsx)(n.code,{children:"related_dim"})," = include ALL related dimensions from metadata."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "ART_ID": 0,\n    "OWNER": "__OWNER__",\n    "CDATA": "__CDATA__",\n    "TREC": "N",\n    "XART03": "055570",\n    "XART20": "Spaghetti alla carbonara",\n    "XART21": {\n      "IVA_ID": 0,\n      "XIVA03": "10",\n      "XIVA04": "IVA 10%",\n      "XIVA05": "10.00"\n    },\n    "XART53": {\n      "DEPFOOD_ID": 0,\n      "XDEPFOOD03": "rep1",\n      "XDEPFOOD04": "Reparto 1"\n    },\n    "XART57": [\n      { "XBCODE03": "05595012" }\n    ],\n    "XART58": [\n      { "XLST10": 9.00, "XLST13": 10.99 }\n    ]\n  }\n]\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Note: ",(0,r.jsx)(n.code,{children:"markers=0"})," replaced IDs with ",(0,r.jsx)(n.code,{children:"__OWNER__"}),", ",(0,r.jsx)(n.code,{children:"__CDATA__"})," placeholders for seed data."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"advanced-parameters",children:"Advanced Parameters"}),"\n",(0,r.jsx)(n.h3,{id:"depth",children:"depth"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Controls recursion depth for nested related dimensions."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"?depth=3\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Default:"})," 3 levels"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Example:"})," Article \u2192 Department \u2192 Category \u2192 Subcategory (3 levels)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Case:"})," Prevent infinite recursion, control response size"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"dim_occurrences",children:"dim_occurrences"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Maximum times the same dimension can appear at any depth level."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"?dim_occurrences=3\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Default:"})," 3 occurrences"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"})," Prevent infinite loops in circular relationships"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Example:"})," If ART appears 4 times in recursion tree, 4th occurrence won't be expanded"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"compact",children:"compact"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Controls response structure."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"?compact=true   # Master dimension fields only\n?compact=false  # Master + all related dimensions expanded\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"compact=true:"})," Returns only master dimension fields (related dims collapsed to IDs)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"compact=false:"})," Returns full nested structure with all related dimension data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," Aggregate Dim dimensions always shown (compact doesn't apply to them)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"use_public_code",children:"use_public_code"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Field names vs public descriptions."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"?use_public_code=true   # Use public field descriptions\n?use_public_code=false  # Use field codes (XART03, etc.)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example with use_public_code=true:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "progressivoArticolo": "055570",\n  "descrizione": "Spaghetti alla carbonara",\n  "PrezzoConsigliato": 9.00,\n  "BarcodeAssociati": [\n    { "codiceEan": "05595012" }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"markers",children:"markers"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Replace metadata fields with placeholders for seed data."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"?markers=1\n"})}),"\n",(0,r.jsx)(n.p,{children:"Replaces:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ID"})," \u2192 ",(0,r.jsx)(n.code,{children:"0"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OWNER"})," \u2192 ",(0,r.jsx)(n.code,{children:"__OWNER__"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"CDATA"})," \u2192 ",(0,r.jsx)(n.code,{children:"__CDATA__"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"LOWNER"})," \u2192 ",(0,r.jsx)(n.code,{children:"__LOWNER__"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"LDATA"})," \u2192 ",(0,r.jsx)(n.code,{children:"__LDATA__"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"TIMESTAMP"})," \u2192 ",(0,r.jsx)(n.code,{children:"__TIMESTAMP__"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Case:"})," Export data for database seeding without environment-specific values."]}),"\n",(0,r.jsx)(n.h3,{id:"center_dett",children:"center_dett"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Field visibility control (same as regular queries)."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"?center_dett=visualizza  # L flag required\n?center_dett=dettaglio   # D flag required\n?center_dett=allviews    # All fields (no COD_ON_OFF filtering)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"debug",children:"debug"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns generated SQL query."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"?debug=true\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response includes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "metadata": true,\n    "sql": "SELECT ... FROM TB_ANAG_ART00 LEFT JOIN TB_ANAG_BCODE00 ..."\n  },\n  { ...document data... }\n]\n'})}),"\n",(0,r.jsx)(n.h3,{id:"pagination",children:"Pagination"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"For filter-based document queries."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"?$offset=0&$num_rows=25\n"})}),"\n",(0,r.jsx)(n.p,{children:"Returns metadata with pagination info:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "metadata": true,\n    "count": 150,\n    "page": 1,\n    "per_page": 25,\n    "total_pages": 6\n  },\n  { ...documents... }\n]\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,r.jsx)(n.h3,{id:"use-case-1-product-detail-page",children:"Use Case 1: Product Detail Page"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario:"})," Display product with all barcodes, prices, inventory, and images."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Pre-defined document or on-the-fly with related_dim including BCODE, LST, STOCK, IMAGES."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Single API call (instead of 5 separate calls)"}),"\n",(0,r.jsx)(n.li,{children:"Consistent data snapshot"}),"\n",(0,r.jsx)(n.li,{children:"Reduced latency"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"use-case-2-order-management",children:"Use Case 2: Order Management"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario:"})," Retrieve order with all line items, payments, shipments."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'POST /api/v4/document\n{\n  "dim": "ORD",\n  "val_key": "ORD-2025-001",\n  "related_dim": {\n    "ORDITEM": [],\n    "PAYMENT": [],\n    "SHIPMENT": []\n  },\n  "compact": false\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"use-case-3-data-export-for-seeding",children:"Use Case 3: Data Export for Seeding"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario:"})," Export production data for test environment seeding."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/document/FULL_ARTICLE_INFO/055570?markers=1&use_public_code=false\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," Clean data with placeholder IDs suitable for import."]}),"\n",(0,r.jsx)(n.h3,{id:"use-case-4-mobile-app-offline-sync",children:"Use Case 4: Mobile App Offline Sync"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scenario:"})," Sync product catalog to mobile app with all related data."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Filter-based document query with pagination:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'POST /api/v4/document\n{\n  "dim": "ART",\n  "filter_val_key": "equals(XART06, 1)",  // Active products only\n  "related_dim": {\n    "BCODE": ["XBCODE03"],\n    "LST": ["XLST10"],\n    "IMAGES": ["XIMG_URL"]\n  },\n  "$offset": 0,\n  "$num_rows": 100\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"when-to-use-document-api-vs-regular-queries",children:"When to Use Document API vs Regular Queries"}),"\n",(0,r.jsx)(n.h3,{id:"use-document-api-when",children:"Use Document API When:"}),"\n",(0,r.jsx)(n.p,{children:"\u2705 You need master record + multiple related dimensions\n\u2705 Data must be consistent (same transaction/state)\n\u2705 Performance matters (reduce round trips)\n\u2705 Relationship structure is complex\n\u2705 You're building mobile/offline features"}),"\n",(0,r.jsx)(n.h3,{id:"use-regular-queries-when",children:"Use Regular Queries When:"}),"\n",(0,r.jsx)(n.p,{children:"\u2705 You only need master dimension data\n\u2705 Related dimensions are loaded on-demand (lazy loading)\n\u2705 You need maximum flexibility in filtering\n\u2705 You're implementing infinite scroll (paginate master only)\n\u2705 Related data updates independently"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"-do",children:"\u2705 DO:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pre-define frequently used documents:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INSERT INTO TB_ANAG_DOCDIM00 (COD_DOCDIM, COD_DIM, ...)\nVALUES ('PRODUCT_DETAIL', 'ART', ...);\n"})}),"\n",(0,r.jsx)(n.p,{children:"Improves maintainability and reusability."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use compact=true for large datasets:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"?compact=true\n"})}),"\n",(0,r.jsx)(n.p,{children:"Reduces response size when you don't need full nested data."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Limit depth for performance:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"?depth=2\n"})}),"\n",(0,r.jsx)(n.p,{children:"Prevents excessively deep recursion."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use pagination for filter-based queries:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "filter_val_key": "...",\n  "$offset": 0,\n  "$num_rows": 100\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"-dont",children:"\u274c DON'T:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't skip required token parameters:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c Bad - missing codLst token\nGET /api/v4/document/SHORT_ARTICLE_INFO/300100?areaListino=ITA\n\n# \u2705 Good\nGET /api/v4/document/SHORT_ARTICLE_INFO/300100?codLst=1&areaListino=ITA\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't set depth too high:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c Bad - excessive recursion\n?depth=10\n\n# \u2705 Good - reasonable limit\n?depth=3\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't use Document API for simple queries:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# \u274c Bad - overkill for single dimension\nPOST /api/v4/document\n{ "dim": "ART", "val_key": "123", "related_dim": {} }\n\n# \u2705 Good - regular query\nGET /api/v4/core/ART/123\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't mix compact and use_public_code incorrectly:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u26a0\ufe0f Warning - compact=true + use_public_code=true may not provide expected nested structure\n?compact=true&use_public_code=true\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"common-errors",children:"Common Errors"}),"\n",(0,r.jsx)(n.h3,{id:"error-missing-token-parameter",children:"Error: Missing Token Parameter"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Problem:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /api/v4/document/SHORT_ARTICLE_INFO/300100\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": 500,\n  "message": "Bad request!, Missing codLst param"\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Include all required token parameters from Aggregate Dim Conditions."]}),"\n",(0,r.jsx)(n.h3,{id:"error-invalid-dimension-in-related_dim",children:"Error: Invalid Dimension in related_dim"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Problem:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "dim": "ART",\n  "related_dim": {\n    "INVALID_DIM": []\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": 400,\n  "message": "Dimension INVALID_DIM not related to ART"\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Only include dimensions defined in TB_OBJECT as related to master dimension."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Document API retrieves master + related dimensions in single call"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Pre-defined documents stored in TB_ANAG_DOCDIM00"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 On-the-fly documents for ad-hoc queries"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Token-based dynamic filtering (Aggregate Dim Conditions)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Advanced parameters: depth, dim_occurrences, compact, use_public_code, markers"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Use for product details, order management, data export, offline sync"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Metadata-driven relationships (no hardcoded joins)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Takeaways:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Single API call = better performance + consistent data"}),"\n",(0,r.jsx)(n.li,{children:"Pre-define commonly used documents for reusability"}),"\n",(0,r.jsx)(n.li,{children:"Use compact=true for large responses"}),"\n",(0,r.jsx)(n.li,{children:"Limit depth to prevent excessive recursion"}),"\n",(0,r.jsx)(n.li,{children:"Token parameters are required (not optional)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-concepts",children:"Related Concepts"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns",children:"Query Patterns Overview"})," - Other query operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/filtering",children:"Filtering"})," - Filter syntax for filter_val_key"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/field-retrieval",children:"Field Retrieval"})," - center_dett and COD_ON_OFF"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/pagination",children:"Pagination"})," - Paginating document results"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/reference/metadata-tables#tb_object---dimension-relationships",children:"Relationships"})," - TB_OBJECT foreign keys"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/reference/cod-on-off-flags",children:"COD_ON_OFF"})," - Field visibility flags"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},2172:(e,n,s)=>{s.d(n,{I:()=>c,M:()=>l});var r=s(1504);const i={},d=r.createContext(i);function l(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);