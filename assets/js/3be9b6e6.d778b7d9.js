"use strict";(self.webpackChunkq_01_docs=self.webpackChunkq_01_docs||[]).push([[6712],{6484:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>c,toc:()=>o});var r=s(7624),i=s(2172);const t={title:"Query Performance",sidebar_label:"Query Performance",sidebar_position:10,description:"Optimization strategies and performance best practices"},a="Query Performance",c={id:"products/map.q01.io/core-api-platform-v4/query-patterns/query-performance",title:"Query Performance",description:"Optimization strategies and performance best practices",source:"@site/docs/products/map.q01.io/core-api-platform-v4/03-query-patterns/query-performance.md",sourceDirName:"products/map.q01.io/core-api-platform-v4/03-query-patterns",slug:"/products/map.q01.io/core-api-platform-v4/query-patterns/query-performance",permalink:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/query-performance",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{title:"Query Performance",sidebar_label:"Query Performance",sidebar_position:10,description:"Optimization strategies and performance best practices"},sidebar:"mapSidebar",previous:{title:"Full-Text Search",permalink:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/full-text-search"},next:{title:"Document Queries",permalink:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/document-queries"}},l={},o=[{value:"Overview",id:"overview",level:2},{value:"Index Optimization",id:"index-optimization",level:2},{value:"Understanding Indexes",id:"understanding-indexes",level:3},{value:"Indexed Fields in Core APIs",id:"indexed-fields-in-core-apis",level:3},{value:"Multi-Column Indexes",id:"multi-column-indexes",level:3},{value:"Field Projection",id:"field-projection",level:2},{value:"Response Size Reduction",id:"response-size-reduction",level:3},{value:"Select Only Needed Fields",id:"select-only-needed-fields",level:3},{value:"Filter Placement",id:"filter-placement",level:2},{value:"Filter Order Matters",id:"filter-order-matters",level:3},{value:"Indexed Filter First",id:"indexed-filter-first",level:3},{value:"Pagination Strategy",id:"pagination-strategy",level:2},{value:"Limit Result Sets",id:"limit-result-sets",level:3},{value:"Deep Pagination Problem",id:"deep-pagination-problem",level:3},{value:"Consistent Sorting",id:"consistent-sorting",level:3},{value:"N+1 Query Problem",id:"n1-query-problem",level:2},{value:"The Problem",id:"the-problem",level:3},{value:"Solution 1: Use TB_OBJECT Views",id:"solution-1-use-tb_object-views",level:3},{value:"Solution 2: Batch Fetching",id:"solution-2-batch-fetching",level:3},{value:"Caching Strategies",id:"caching-strategies",level:2},{value:"Client-Side Caching",id:"client-side-caching",level:3},{value:"Cache Invalidation",id:"cache-invalidation",level:3},{value:"HTTP Cache Headers",id:"http-cache-headers",level:3},{value:"Performance Monitoring",id:"performance-monitoring",level:2},{value:"Measure Query Performance",id:"measure-query-performance",level:3},{value:"Performance Benchmarks",id:"performance-benchmarks",level:3},{value:"Common Performance Pitfalls",id:"common-performance-pitfalls",level:2},{value:"Pitfall 1: Fetching All Records",id:"pitfall-1-fetching-all-records",level:3},{value:"Pitfall 2: No Field Projection",id:"pitfall-2-no-field-projection",level:3},{value:"Pitfall 3: N+1 Queries",id:"pitfall-3-n1-queries",level:3},{value:"Pitfall 4: No Sorting with Pagination",id:"pitfall-4-no-sorting-with-pagination",level:3},{value:"Pitfall 5: Leading Wildcard Search",id:"pitfall-5-leading-wildcard-search",level:3},{value:"Best Practices Summary",id:"best-practices-summary",level:2},{value:"\u2705 DO:",id:"-do",level:3},{value:"\u274c DON&#39;T:",id:"-dont",level:3},{value:"Summary",id:"summary",level:2},{value:"Related Concepts",id:"related-concepts",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"query-performance",children:"Query Performance"}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["Query performance determines user experience. Core APIs provide efficient data access, but ",(0,r.jsx)(n.strong,{children:"query design matters"}),". This guide covers optimization strategies, common pitfalls, and performance monitoring."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Factors:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Index usage"}),"\n",(0,r.jsx)(n.li,{children:"Field projection"}),"\n",(0,r.jsx)(n.li,{children:"Filter placement"}),"\n",(0,r.jsx)(n.li,{children:"Pagination strategy"}),"\n",(0,r.jsx)(n.li,{children:"N+1 query problems"}),"\n",(0,r.jsx)(n.li,{children:"Caching"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"index-optimization",children:"Index Optimization"}),"\n",(0,r.jsx)(n.h3,{id:"understanding-indexes",children:"Understanding Indexes"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Indexes speed up queries by creating ordered data structures:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Without index: Full table scan (slow)\nSELECT * FROM TB_ANAG_PRD00 WHERE XPRD05 = 'Electronics'; -- Scans all rows\n\n-- With index: Index seek (fast)\nCREATE INDEX idx_category ON TB_ANAG_PRD00(XPRD05);\nSELECT * FROM TB_ANAG_PRD00 WHERE XPRD05 = 'Electronics'; -- Uses index\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Performance Impact:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Without index"}),": O(n) - scans every row"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"With index"}),": O(log n) - binary search"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"100,000 records without index: ~500ms"}),"\n",(0,r.jsx)(n.li,{children:"100,000 records with index: ~5ms (100x faster)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"indexed-fields-in-core-apis",children:"Indexed Fields in Core APIs"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Primary Key (Always Indexed):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Fast - primary key lookup\nGET /api/v4/core/PRD/123\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Counter Fields (XPRD03 - Indexed):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Fast - counter field is indexed\n$filter=XPRD03 eq 'PRD-2025-001'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Category/Foreign Keys (Usually Indexed):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Fast - foreign key index\n$filter=XPRD05 eq 'cat_electronics'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Text Fields (Not Indexed by Default):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u26a0\ufe0f Slower - no index on text field\n$filter=contains(XPRD04,'description')\n"})}),"\n",(0,r.jsx)(n.h3,{id:"multi-column-indexes",children:"Multi-Column Indexes"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Indexes support left-to-right matching:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Index on (XPRD05, XPRD06)\nCREATE INDEX idx_category_active ON TB_ANAG_PRD00(XPRD05, XPRD06);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Uses Index:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Good - uses index\n$filter=XPRD05 eq 'Electronics' AND XPRD06 eq true\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Partial Index Usage:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Good - uses index (first column)\n$filter=XPRD05 eq 'Electronics'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"No Index Usage:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c Bad - cannot use index (missing first column)\n$filter=XPRD06 eq true\n"})}),"\n",(0,r.jsx)(n.h2,{id:"field-projection",children:"Field Projection"}),"\n",(0,r.jsx)(n.h3,{id:"response-size-reduction",children:"Response Size Reduction"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Field projection dramatically reduces response size:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c Bad - 10KB response, 250ms query\nGET /api/v4/core/PRD?source=productList\n\n# \u2705 Good - 1KB response, 25ms query\nGET /api/v4/core/PRD?source=productList&\\\n  $select=PRD_ID,XPRD01,XPRD02\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Performance Impact:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"90% smaller response size"}),"\n",(0,r.jsx)(n.li,{children:"10x faster network transfer"}),"\n",(0,r.jsx)(n.li,{children:"5x faster JSON parsing"}),"\n",(0,r.jsx)(n.li,{children:"Lower memory usage"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"select-only-needed-fields",children:"Select Only Needed Fields"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"List views (minimal fields):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Good - list view\n$select=PRD_ID,XPRD01,XPRD02,XPRD12\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Detail views (more fields):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Good - detail view\n$select=PRD_ID,XPRD01,XPRD02,XPRD04,XPRD05,XPRD06,XPRD09,XPRD12\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Autocomplete (absolute minimum):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Good - autocomplete\n$select=PRD_ID,XPRD01\n"})}),"\n",(0,r.jsx)(n.h2,{id:"filter-placement",children:"Filter Placement"}),"\n",(0,r.jsx)(n.h3,{id:"filter-order-matters",children:"Filter Order Matters"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Apply most selective filters first:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Good - specific filter first (reduces result set early)\n$filter=XPRD03 eq 'PRD-2025-001' AND XPRD06 eq true\n\n# \u26a0\ufe0f Slower - broad filter first\n$filter=XPRD06 eq true AND XPRD03 eq 'PRD-2025-001'\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why?"})," Database query optimizer evaluates filters left-to-right (in most cases). Specific filters reduce the working set faster."]}),"\n",(0,r.jsx)(n.h3,{id:"indexed-filter-first",children:"Indexed Filter First"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Good - indexed field first\n$filter=XPRD05 eq 'Electronics' AND contains(XPRD04,'description')\n\n# \u26a0\ufe0f Slower - non-indexed field first\n$filter=contains(XPRD04,'description') AND XPRD05 eq 'Electronics'\n"})}),"\n",(0,r.jsx)(n.h2,{id:"pagination-strategy",children:"Pagination Strategy"}),"\n",(0,r.jsx)(n.h3,{id:"limit-result-sets",children:"Limit Result Sets"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Always paginate large queries:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c Bad - fetches all records (slow, memory intensive)\nGET /api/v4/core/PRD?source=productList\n\n# \u2705 Good - limited result set\nGET /api/v4/core/PRD?source=productList&$num_rows=25&$offset=0\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Performance Impact:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"100,000 records without pagination: 5-10 seconds, 50MB response"}),"\n",(0,r.jsx)(n.li,{children:"25 records with pagination: 50ms, 50KB response (100x faster)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"deep-pagination-problem",children:"Deep Pagination Problem"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Performance degrades with high $offset:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Fast - page 1 (~25ms)\n$offset=0&$num_rows=25\n\n# \u26a0\ufe0f Slower - page 100 (~100ms)\n$offset=2475&$num_rows=25\n\n# \u274c Very slow - page 1000 (~1000ms)\n$offset=24975&$num_rows=25\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why?"})," Database must scan and skip first N rows before returning results."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solution 1: Limit maximum page number"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const MAX_PAGE = 100;\nif (pageNumber > MAX_PAGE) {\n  throw new Error('Page number too high');\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solution 2: Cursor-based pagination"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Page 1\nGET /api/v4/core/PRD?$num_rows=25&$order=PRD_ID ASC\n\n# Page 2 - use last ID as cursor\nGET /api/v4/core/PRD?$filter=PRD_ID gt 25&$num_rows=25&$order=PRD_ID ASC\n"})}),"\n",(0,r.jsx)(n.h3,{id:"consistent-sorting",children:"Consistent Sorting"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Always specify $order with pagination:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c Bad - unpredictable order (duplicates/missing records)\n$num_rows=25&$offset=0\n$num_rows=25&$offset=25\n\n# \u2705 Good - consistent order\n$num_rows=25&$offset=0&$order=PRD_ID ASC\n$num_rows=25&$offset=25&$order=PRD_ID ASC\n"})}),"\n",(0,r.jsx)(n.h2,{id:"n1-query-problem",children:"N+1 Query Problem"}),"\n",(0,r.jsx)(n.h3,{id:"the-problem",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fetching related data in loops causes N+1 queries:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Bad - N+1 queries (1 + 100 = 101 API calls)\nasync function loadProductsWithCategory() {\n  // 1 query to get products\n  const products = await fetch(`${apiBase}/api/v4/core/PRD?$num_rows=100`);\n\n  // N queries to get each category (100 additional calls)\n  for (const product of products.data) {\n    const category = await fetch(`${apiBase}/api/v4/core/CAT/${product.XPRD05}`);\n    product.categoryName = category.data.XCAT01;\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"solution-1-use-tb_object-views",children:"Solution 1: Use TB_OBJECT Views"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Join data in single query:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Define view in TB_OBJECT\nINSERT INTO TB_OBJECT (NAME_OBJ, COD_DIM, TYPE_OBJ, VIEW_SCHEMA) VALUES (\n  'V_PRODUCTS_CATEGORY', 'PRD', 1,\n  'SELECT p.PRD_ID, p.XPRD01, p.XPRD02, c.XCAT01 as CATEGORY_NAME\n   FROM TB_ANAG_PRD00 p\n   LEFT JOIN TB_ANAG_CAT00 c ON p.XPRD05 = c.CAT_ID\n   WHERE p.TREC != ''C'''\n);\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 Good - single query with join\nasync function loadProductsWithCategory() {\n  const products = await fetch(\n    `${apiBase}/api/v4/core/PRD?source=productsWithCategory&$num_rows=100`\n  );\n  // All data included in single response\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"solution-2-batch-fetching",children:"Solution 2: Batch Fetching"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fetch related records in single request:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 Good - 2 queries instead of 101\nasync function loadProductsWithCategory() {\n  // 1 query to get products\n  const products = await fetch(`${apiBase}/api/v4/core/PRD?$num_rows=100`);\n\n  // Extract unique category IDs\n  const categoryIds = [...new Set(products.data.map(p => p.XPRD05))];\n\n  // 1 query to get all categories\n  const categories = await fetch(\n    `${apiBase}/api/v4/core/CAT?$filter=CAT_ID IN (${categoryIds.join(',')})`\n  );\n\n  // Map categories to products\n  const categoryMap = {};\n  categories.data.forEach(cat => categoryMap[cat.CAT_ID] = cat.XCAT01);\n  products.data.forEach(p => p.categoryName = categoryMap[p.XPRD05]);\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"caching-strategies",children:"Caching Strategies"}),"\n",(0,r.jsx)(n.h3,{id:"client-side-caching",children:"Client-Side Caching"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cache API responses in browser:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"class CachedAPIClient {\n  constructor(apiBase, token) {\n    this.apiBase = apiBase;\n    this.token = token;\n    this.cache = new Map();\n    this.cacheTTL = 5 * 60 * 1000; // 5 minutes\n  }\n\n  getCacheKey(url) {\n    return url.toString();\n  }\n\n  isCacheValid(entry) {\n    return Date.now() - entry.timestamp < this.cacheTTL;\n  }\n\n  async fetch(url) {\n    const key = this.getCacheKey(url);\n    const cached = this.cache.get(key);\n\n    // Return cached if valid\n    if (cached && this.isCacheValid(cached)) {\n      return cached.data;\n    }\n\n    // Fetch from API\n    const response = await fetch(url, {\n      headers: { 'Authorization': `Bearer ${this.token}` }\n    });\n    const data = await response.json();\n\n    // Store in cache\n    this.cache.set(key, {\n      data,\n      timestamp: Date.now()\n    });\n\n    return data;\n  }\n\n  invalidate(pattern) {\n    // Clear cache entries matching pattern\n    for (const key of this.cache.keys()) {\n      if (key.includes(pattern)) {\n        this.cache.delete(key);\n      }\n    }\n  }\n}\n\n// Usage\nconst api = new CachedAPIClient(apiBase, token);\n\n// First call - fetches from API\nconst products1 = await api.fetch(\n  new URL(`${apiBase}/api/v4/core/PRD?source=productList&$num_rows=25`)\n);\n\n// Second call within 5 minutes - returns cached\nconst products2 = await api.fetch(\n  new URL(`${apiBase}/api/v4/core/PRD?source=productList&$num_rows=25`)\n);\n\n// Invalidate cache after update\nawait updateProduct(123);\napi.invalidate('/api/v4/core/PRD');\n"})}),"\n",(0,r.jsx)(n.h3,{id:"cache-invalidation",children:"Cache Invalidation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Invalidate cache after writes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"class ProductService {\n  constructor(apiBase, token) {\n    this.api = new CachedAPIClient(apiBase, token);\n  }\n\n  async getProducts(options) {\n    const url = new URL(`${this.api.apiBase}/api/v4/core/PRD`);\n    url.searchParams.append('source', 'productList');\n    // ... add options\n    return this.api.fetch(url);\n  }\n\n  async updateProduct(id, data) {\n    // Update product\n    const response = await fetch(`${this.api.apiBase}/api/v4/core/PRD/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Bearer ${this.api.token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    });\n\n    // Invalidate product list cache\n    this.api.invalidate('/api/v4/core/PRD');\n\n    return response.json();\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"http-cache-headers",children:"HTTP Cache Headers"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Core APIs support standard HTTP caching:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Let browser handle caching\nconst response = await fetch(url, {\n  headers: { 'Authorization': `Bearer ${token}` },\n  cache: 'default' // Use browser cache\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cache-Control headers:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Cache-Control: public, max-age=300"})," - Cache for 5 minutes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Cache-Control: no-cache"})," - Validate before use"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Cache-Control: no-store"})," - Never cache"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"performance-monitoring",children:"Performance Monitoring"}),"\n",(0,r.jsx)(n.h3,{id:"measure-query-performance",children:"Measure Query Performance"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"class PerformanceMonitor {\n  static async measureQuery(queryFn, label) {\n    const startTime = performance.now();\n    const result = await queryFn();\n    const endTime = performance.now();\n    const duration = endTime - startTime;\n\n    console.log(`[${label}] Query took ${duration.toFixed(2)}ms`);\n\n    // Alert if slow\n    if (duration > 1000) {\n      console.warn(`[${label}] Slow query detected: ${duration.toFixed(2)}ms`);\n    }\n\n    return result;\n  }\n}\n\n// Usage\nconst products = await PerformanceMonitor.measureQuery(\n  () => fetch(`${apiBase}/api/v4/core/PRD?source=productList&$num_rows=25`),\n  'Product List'\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"performance-benchmarks",children:"Performance Benchmarks"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Target response times:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Query Type"}),(0,r.jsx)(n.th,{children:"Target"}),(0,r.jsx)(n.th,{children:"Acceptable"}),(0,r.jsx)(n.th,{children:"Slow"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Primary key lookup"}),(0,r.jsx)(n.td,{children:"<10ms"}),(0,r.jsx)(n.td,{children:"<50ms"}),(0,r.jsx)(n.td,{children:">100ms"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Indexed filter"}),(0,r.jsx)(n.td,{children:"<50ms"}),(0,r.jsx)(n.td,{children:"<200ms"}),(0,r.jsx)(n.td,{children:">500ms"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Full-text search"}),(0,r.jsx)(n.td,{children:"<100ms"}),(0,r.jsx)(n.td,{children:"<500ms"}),(0,r.jsx)(n.td,{children:">1000ms"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Complex join"}),(0,r.jsx)(n.td,{children:"<200ms"}),(0,r.jsx)(n.td,{children:"<1000ms"}),(0,r.jsx)(n.td,{children:">2000ms"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Aggregation"}),(0,r.jsx)(n.td,{children:"<500ms"}),(0,r.jsx)(n.td,{children:"<2000ms"}),(0,r.jsx)(n.td,{children:">5000ms"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"common-performance-pitfalls",children:"Common Performance Pitfalls"}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-1-fetching-all-records",children:"Pitfall 1: Fetching All Records"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Bad - fetches 100k records\nconst products = await fetch(`${apiBase}/api/v4/core/PRD?source=productList`);\n\n// \u2705 Good - fetches 25 records\nconst products = await fetch(`${apiBase}/api/v4/core/PRD?source=productList&$num_rows=25`);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-2-no-field-projection",children:"Pitfall 2: No Field Projection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Bad - returns all 50 fields (500KB response)\nconst products = await fetch(`${apiBase}/api/v4/core/PRD?source=productList&$num_rows=25`);\n\n// \u2705 Good - returns 3 fields (50KB response, 10x faster)\nconst products = await fetch(\n  `${apiBase}/api/v4/core/PRD?source=productList&$num_rows=25&$select=PRD_ID,XPRD01,XPRD02`\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-3-n1-queries",children:"Pitfall 3: N+1 Queries"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Bad - 101 API calls\nfor (const product of products) {\n  const category = await fetch(`${apiBase}/api/v4/core/CAT/${product.XPRD05}`);\n}\n\n// \u2705 Good - 1 API call with TB_OBJECT view\nconst products = await fetch(\n  `${apiBase}/api/v4/core/PRD?source=productsWithCategory&$num_rows=100`\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-4-no-sorting-with-pagination",children:"Pitfall 4: No Sorting with Pagination"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Bad - inconsistent results across pages\nconst page1 = await fetch(`${apiBase}/api/v4/core/PRD?$num_rows=25&$offset=0`);\nconst page2 = await fetch(`${apiBase}/api/v4/core/PRD?$num_rows=25&$offset=25`);\n\n// \u2705 Good - consistent results\nconst page1 = await fetch(`${apiBase}/api/v4/core/PRD?$num_rows=25&$offset=0&$order=PRD_ID ASC`);\nconst page2 = await fetch(`${apiBase}/api/v4/core/PRD?$num_rows=25&$offset=25&$order=PRD_ID ASC`);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-5-leading-wildcard-search",children:"Pitfall 5: Leading Wildcard Search"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Bad - full table scan on 100k records\nconst products = await fetch(\n  `${apiBase}/api/v4/core/PRD?$filter=contains(XPRD01,'widget')`\n);\n\n// \u2705 Good - prefix search uses index\nconst products = await fetch(\n  `${apiBase}/api/v4/core/PRD?$filter=startwith(XPRD01,'widget')`\n);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices-summary",children:"Best Practices Summary"}),"\n",(0,r.jsx)(n.h3,{id:"-do",children:"\u2705 DO:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use indexes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Filter by indexed fields\n$filter=XPRD05 eq 'Electronics'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Project fields:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Select only needed fields\n$select=PRD_ID,XPRD01,XPRD02\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Always paginate:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Limit result sets\n$num_rows=25&$offset=0\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Sort consistently:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u2705 Specify $order with pagination\n$order=PRD_ID ASC\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use TB_OBJECT views:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- \u2705 Join data in database\nCREATE VIEW V_PRODUCTS_CATEGORY AS SELECT ...\n"})}),"\n",(0,r.jsx)(n.h3,{id:"-dont",children:"\u274c DON'T:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't fetch all records:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c No pagination\nGET /api/v4/core/PRD?source=productList\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't skip field projection:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c Returns all fields\nGET /api/v4/core/PRD?source=productList\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't use N+1 queries:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Loop with API calls\nfor (const product of products) {\n  await fetch(`${apiBase}/api/v4/core/CAT/${product.XPRD05}`);\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Don't paginate without sorting:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u274c Missing $order\n$num_rows=25&$offset=25\n"})}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Index usage"})," is critical for performance"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Field projection"})," reduces response size 10-17x"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Pagination"})," is mandatory for large datasets"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Consistent sorting"})," prevents duplicate/missing records"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"TB_OBJECT views"})," solve N+1 query problems"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Caching"})," reduces API calls and improves UX"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Monitor performance"})," to identify slow queries"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Takeaways:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Always use indexed fields in filters"}),"\n",(0,r.jsx)(n.li,{children:"Project only needed fields ($select)"}),"\n",(0,r.jsx)(n.li,{children:"Paginate all list queries ($num_rows/$offset)"}),"\n",(0,r.jsx)(n.li,{children:"Sort consistently with pagination ($order)"}),"\n",(0,r.jsx)(n.li,{children:"Avoid N+1 queries (use TB_OBJECT views)"}),"\n",(0,r.jsx)(n.li,{children:"Cache read-heavy queries (5-minute TTL)"}),"\n",(0,r.jsx)(n.li,{children:"Monitor and optimize slow queries (>1s)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Performance Checklist:"})}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Filters use indexed fields"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","$select reduces response size"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","$num_rows limits result set"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","$order ensures consistency"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No N+1 query patterns"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Caching for read-heavy queries"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Performance monitoring enabled"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-concepts",children:"Related Concepts"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/pagination",children:"Pagination"})," - Offset-based pagination"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/field-projection",children:"Field Projection"})," - Response size optimization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/relational-queries",children:"Relational Queries"})," - TB_OBJECT views"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/query-patterns/full-text-search",children:"Full-Text Search"})," - Index-friendly search"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},2172:(e,n,s)=>{s.d(n,{I:()=>c,M:()=>a});var r=s(1504);const i={},t=r.createContext(i);function a(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);