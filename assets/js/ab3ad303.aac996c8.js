"use strict";(self.webpackChunkq_01_docs=self.webpackChunkq_01_docs||[]).push([[7220],{1676:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>o});var n=t(7624),i=t(2172);const a={title:"Security Checklist",sidebar_label:"Security Checklist",sidebar_position:8,description:"Best practices and common security pitfalls"},r="Security Checklist",l={id:"products/map.q01.io/core-api-platform-v4/security/security-checklist",title:"Security Checklist",description:"Best practices and common security pitfalls",source:"@site/docs/products/map.q01.io/core-api-platform-v4/05-security/security-checklist.md",sourceDirName:"products/map.q01.io/core-api-platform-v4/05-security",slug:"/products/map.q01.io/core-api-platform-v4/security/security-checklist",permalink:"/docs/products/map.q01.io/core-api-platform-v4/security/security-checklist",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{title:"Security Checklist",sidebar_label:"Security Checklist",sidebar_position:8,description:"Best practices and common security pitfalls"},sidebar:"mapSidebar",previous:{title:"Audit Trail",permalink:"/docs/products/map.q01.io/core-api-platform-v4/security/audit-trail"},next:{title:"Advanced Topics",permalink:"/docs/products/map.q01.io/core-api-platform-v4/advanced-topics/"}},c={},o=[{value:"Overview",id:"overview",level:2},{value:"Authentication",id:"authentication",level:2},{value:"\u2705 Token Management",id:"-token-management",level:3},{value:"\u274c Common Mistakes",id:"-common-mistakes",level:3},{value:"Authorization",id:"authorization",level:2},{value:"\u2705 Grant Management",id:"-grant-management",level:3},{value:"\u274c Common Mistakes",id:"-common-mistakes-1",level:3},{value:"Tenant Isolation",id:"tenant-isolation",level:2},{value:"\u2705 Multi-Tenant Security",id:"-multi-tenant-security",level:3},{value:"\u274c Common Mistakes",id:"-common-mistakes-2",level:3},{value:"Context Security",id:"context-security",level:2},{value:"\u2705 Context Management",id:"-context-management",level:3},{value:"\u274c Common Mistakes",id:"-common-mistakes-3",level:3},{value:"Rate Limiting",id:"rate-limiting",level:2},{value:"\u2705 API Usage",id:"-api-usage",level:3},{value:"\u274c Common Mistakes",id:"-common-mistakes-4",level:3},{value:"Audit Trail",id:"audit-trail",level:2},{value:"\u2705 Compliance",id:"-compliance",level:3},{value:"\u274c Common Mistakes",id:"-common-mistakes-5",level:3},{value:"Input Validation",id:"input-validation",level:2},{value:"\u2705 Data Safety",id:"-data-safety",level:3},{value:"\u274c Common Mistakes",id:"-common-mistakes-6",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"\u2705 Secure Errors",id:"-secure-errors",level:3},{value:"\u274c Common Mistakes",id:"-common-mistakes-7",level:3},{value:"HTTPS and Transport Security",id:"https-and-transport-security",level:2},{value:"\u2705 Encryption",id:"-encryption",level:3},{value:"\u274c Common Mistakes",id:"-common-mistakes-8",level:3},{value:"Security Testing",id:"security-testing",level:2},{value:"\u2705 Testing Checklist",id:"-testing-checklist",level:3},{value:"Security Test Examples",id:"security-test-examples",level:3},{value:"Deployment Checklist",id:"deployment-checklist",level:2},{value:"\u2705 Production Readiness",id:"-production-readiness",level:3},{value:"Summary",id:"summary",level:2},{value:"Related Concepts",id:"related-concepts",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.M)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"security-checklist",children:"Security Checklist"}),"\n",(0,n.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,n.jsx)(s.p,{children:"This checklist summarizes security best practices for Q01 Core APIs. Use this as a reference when implementing applications, reviewing code, or conducting security audits."}),"\n",(0,n.jsx)(s.h2,{id:"authentication",children:"Authentication"}),"\n",(0,n.jsx)(s.h3,{id:"-token-management",children:"\u2705 Token Management"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use HTTPS in production"})," - Never send JWT tokens over unencrypted HTTP"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Store tokens securely"})," - Use httpOnly cookies (not localStorage)"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Implement token refresh"})," - Refresh access tokens before expiration"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Handle token expiration"})," - Gracefully handle 401 errors with refresh"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Rotate JWT secrets"})," - Change JWT_SECRET regularly (monthly)"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Set appropriate TTL"})," - Access tokens: 1 hour, Refresh tokens: 30 days"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Include complete context"})," - Ensure tokens have source/centro_dett/peso/ambiente"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Clear tokens on logout"})," - Remove all tokens from storage"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"-common-mistakes",children:"\u274c Common Mistakes"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-javascript",children:"// \u274c Bad - localStorage (XSS vulnerable)\nlocalStorage.setItem('token', jwt);\n\n// \u2705 Good - httpOnly cookie\ndocument.cookie = `token=${jwt}; HttpOnly; Secure; SameSite=Strict`;\n\n// \u274c Bad - token in URL\nfetch(`/api/products?token=${token}`);\n\n// \u2705 Good - Authorization header\nfetch('/api/products', {\n  headers: { 'Authorization': `Bearer ${token}` }\n});\n\n// \u274c Bad - logging tokens\nconsole.log('Token:', token);\n\n// \u2705 Good - log without sensitive data\nconsole.log('Token expires at:', payload.exp);\n"})}),"\n",(0,n.jsx)(s.h2,{id:"authorization",children:"Authorization"}),"\n",(0,n.jsx)(s.h3,{id:"-grant-management",children:"\u2705 Grant Management"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Check grants server-side"})," - Never trust client-side grant checks alone"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use hierarchical grants"})," - Leverage TB_MENU nested set for broad permissions"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Hide unavailable actions"})," - Check grants client-side for better UX"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Request minimal grants"})," - Apply principle of least privilege"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use roles"})," - Group related grants into roles for easier management"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Validate on every request"})," - Don't cache grant decisions"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Handle 403 gracefully"}),' - Show clear "access denied" messages']}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"-common-mistakes-1",children:"\u274c Common Mistakes"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-javascript",children:'// \u274c Bad - client-side only\nif (hasGrant(\'products.write\')) {\n  await createProduct(data);  // Server must still check!\n}\n\n// \u2705 Good - client-side for UX, server validates\n{hasGrant(\'products.write\') && <CreateButton />}\nawait createProduct(data);  // Server validates grant\n\n// \u274c Bad - hardcoded permissions\nif (user.email === \'admin@example.com\') {\n  // Allow\n}\n\n// \u2705 Good - grant-based\nif (checkGrant(user.grants, \'products.write\')) {\n  // Allow\n}\n\n// \u274c Bad - exposing all grants in error\n{\n  "error": "Grant denied",\n  "user_grants": ["secret.admin", "internal.grant"]\n}\n\n// \u2705 Good - minimal info\n{\n  "error": "Insufficient permissions",\n  "code": "GRANT_DENIED"\n}\n'})}),"\n",(0,n.jsx)(s.h2,{id:"tenant-isolation",children:"Tenant Isolation"}),"\n",(0,n.jsx)(s.h3,{id:"-multi-tenant-security",children:"\u2705 Multi-Tenant Security"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Always set source during login"})," - Explicit tenant identification"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Never override source"})," - Trust automatic filtering"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Validate session context"})," - Ensure source/centro_dett present"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test cross-tenant access"})," - Verify isolation in tests"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use source for customization"})," - Tenant-specific features"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Monitor cross-tenant attempts"})," - Alert on suspicious access patterns"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Document tenant structure"})," - Clear source naming conventions"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"-common-mistakes-2",children:"\u274c Common Mistakes"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-javascript",children:"// \u274c Bad - missing tenant\nawait login(username, password);\n\n// \u2705 Good - explicit tenant\nawait login(username, password, 'tenantA', 'admin');\n\n// \u274c Bad - trying to override\nawait createProduct({\n  XPRD01: 'Widget',\n  PRD_SOURCE: 'otherTenant'  // Error!\n});\n\n// \u2705 Good - let Core APIs set source\nawait createProduct({\n  XPRD01: 'Widget'\n  // PRD_SOURCE set automatically\n});\n\n// \u274c Bad - assuming cross-tenant access\nconst product = await getProduct(otherTenantId);  // 404\n\n// \u2705 Good - respect tenant boundaries\nconst product = await getProduct(myTenantId);\n"})}),"\n",(0,n.jsx)(s.h2,{id:"context-security",children:"Context Security"}),"\n",(0,n.jsx)(s.h3,{id:"-context-management",children:"\u2705 Context Management"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Set complete context at login"})," - source/centro_dett/peso/ambiente"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use peso appropriately"})," - Admin=1, Manager=2, User=3"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Separate environments"})," - Never mix production and test"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Respect hierarchical peso"})," - Lower numbers see more"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Match centro_dett exactly"})," - No hierarchical inference"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Trust automatic filtering"})," - Core APIs handle all context filtering"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test context isolation"})," - Verify peso/ambiente filtering works"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"-common-mistakes-3",children:"\u274c Common Mistakes"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-javascript",children:"// \u274c Bad - incomplete context\nawait login(username, password, source);\n\n// \u2705 Good - complete context\nawait login(username, password, {\n  source: 'retailChain',\n  centro_dett: 'store_001',\n  peso: '2',\n  ambiente: 'production'\n});\n\n// \u274c Bad - trying to override peso\nawait createProduct({\n  XPRD01: 'Admin Product',\n  PRD_PESO: '1'  // Error!\n});\n\n// \u2705 Good - peso from session\nawait createProduct({\n  XPRD01: 'Product'\n  // PRD_PESO set from session\n});\n\n// \u274c Bad - mixing environments\nif (ambiente === 'test') {\n  // But still accessing production data?\n}\n\n// \u2705 Good - separate sessions entirely\n// Test session: ambiente='test'\n// Production session: ambiente='production'\n"})}),"\n",(0,n.jsx)(s.h2,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,n.jsx)(s.h3,{id:"-api-usage",children:"\u2705 API Usage"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Monitor rate limit headers"})," - Check X-RateLimit-Remaining"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Implement exponential backoff"})," - Retry with increasing delays"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Throttle batch operations"})," - Limit concurrent requests (10-20 max)"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Cache responses"})," - Reduce redundant API calls"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Handle 429 gracefully"})," - Wait for Retry-After"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use appropriate limits"})," - Different limits for reads vs writes"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Monitor API usage"})," - Track rate limit consumption"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"-common-mistakes-4",children:"\u274c Common Mistakes"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-javascript",children:"// \u274c Bad - ignoring rate limits\nawait fetch(url);  // No rate limit awareness\n\n// \u2705 Good - monitor and respect\nconst remaining = response.headers.get('X-RateLimit-Remaining');\nif (remaining < 50) {\n  console.warn('Low rate limit');\n}\n\n// \u274c Bad - immediate retry on 429\nif (response.status === 429) {\n  return fetch(url);  // No wait!\n}\n\n// \u2705 Good - exponential backoff\nif (response.status === 429) {\n  const retryAfter = response.headers.get('Retry-After');\n  await sleep(retryAfter * 1000);\n  return fetch(url);\n}\n\n// \u274c Bad - unbounded parallel requests\nawait Promise.all(\n  largeArray.map(item => createItem(item))\n);\n\n// \u2705 Good - throttled\nconst throttler = new RequestThrottler(10);\nawait Promise.all(\n  largeArray.map(item =>\n    throttler.throttle(() => createItem(item))\n  )\n);\n"})}),"\n",(0,n.jsx)(s.h2,{id:"audit-trail",children:"Audit Trail"}),"\n",(0,n.jsx)(s.h3,{id:"-compliance",children:"\u2705 Compliance"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Trust automatic audit fields"})," - Don't try to override"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use soft delete"})," - Preserve audit trail"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Query OUTBOX for history"})," - Complete operation log"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Export audit data"})," - GDPR data access requests"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Implement data retention"})," - Cleanup old audit records"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Monitor suspicious activity"})," - Alert on unusual patterns"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Document audit procedures"})," - Compliance requirements"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"-common-mistakes-5",children:"\u274c Common Mistakes"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-javascript",children:"// \u274c Bad - overriding audit fields\nawait createProduct({\n  XPRD01: 'Widget',\n  CREATED_BY: 'other@example.com'  // Error!\n});\n\n// \u2705 Good - automatic audit\nawait createProduct({\n  XPRD01: 'Widget'\n  // CREATED_BY set automatically\n});\n\n// \u274c Bad - force delete (no audit)\nDELETE /api/v4/core/PRD/123?force=true\n\n// \u2705 Good - soft delete (preserves audit)\nDELETE /api/v4/core/PRD/123\n\n// \u274c Bad - modifying OUTBOX\nUPDATE OUTBOX SET USER = 'anonymous';\n\n// \u2705 Good - OUTBOX is append-only\n// Query for audit history, don't modify\n"})}),"\n",(0,n.jsx)(s.h2,{id:"input-validation",children:"Input Validation"}),"\n",(0,n.jsx)(s.h3,{id:"-data-safety",children:"\u2705 Data Safety"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Validate all inputs"})," - Never trust client data"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Sanitize user input"})," - Prevent XSS attacks"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use parameterized queries"})," - Prevent SQL injection (Core APIs handle this)"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Enforce required fields"})," - Check before API call"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Validate data types"})," - Numbers, dates, emails"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Limit string lengths"})," - Prevent buffer overflow"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Check field permissions"})," - Respect COD_ON_OFF flags"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"-common-mistakes-6",children:"\u274c Common Mistakes"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-javascript",children:"// \u274c Bad - no validation\nconst data = req.body;\nawait createProduct(data);\n\n// \u2705 Good - validate first\nconst validated = validateProduct(req.body);\nif (validated.errors) {\n  return res.status(400).json(validated.errors);\n}\nawait createProduct(validated.data);\n\n// \u274c Bad - storing sensitive data\nawait createUser({\n  username: 'user@example.com',\n  password: 'plaintext'  // Never!\n});\n\n// \u2705 Good - hash passwords\nconst hashedPassword = await bcrypt.hash(password, 10);\nawait createUser({\n  username: 'user@example.com',\n  password_hash: hashedPassword\n});\n\n// \u274c Bad - trusting client-side validation only\n// Client: <input required />\nawait createProduct(data);  // Server must also validate!\n\n// \u2705 Good - server-side validation\n// Client: <input required />\n// Server: if (!data.XPRD01) throw ValidationError\n"})}),"\n",(0,n.jsx)(s.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,n.jsx)(s.h3,{id:"-secure-errors",children:"\u2705 Secure Errors"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Hide implementation details"})," - No stack traces in production"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use error codes"})," - Machine-readable error handling"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Log errors securely"})," - Don't log sensitive data"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Return appropriate status codes"})," - 401, 403, 404, 500"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Handle errors gracefully"})," - User-friendly messages"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Don't leak information"})," - 404 for cross-tenant access (not 403)"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Monitor error rates"})," - Alert on unusual patterns"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"-common-mistakes-7",children:"\u274c Common Mistakes"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-javascript",children:"// \u274c Bad - exposing stack trace\ncatch (error) {\n  res.status(500).json({ error: error.stack });\n}\n\n// \u2705 Good - generic error message\ncatch (error) {\n  console.error('Error:', error);  // Log server-side\n  res.status(500).json({\n    error: 'Internal server error',\n    code: 'INTERNAL_ERROR'\n  });\n}\n\n// \u274c Bad - revealing existence\nif (!canAccess(record)) {\n  return 403;  // Reveals record exists\n}\n\n// \u2705 Good - uniform response\nif (!canAccess(record)) {\n  return 404;  // Same as \"not found\"\n}\n\n// \u274c Bad - logging sensitive data\nconsole.log('User credentials:', { username, password });\n\n// \u2705 Good - log without secrets\nconsole.log('Login attempt:', { username, success: true });\n"})}),"\n",(0,n.jsx)(s.h2,{id:"https-and-transport-security",children:"HTTPS and Transport Security"}),"\n",(0,n.jsx)(s.h3,{id:"-encryption",children:"\u2705 Encryption"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Always use HTTPS in production"})," - No exceptions"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Enforce TLS 1.2+"})," - Disable older protocols"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use strong cipher suites"})," - Modern encryption algorithms"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Implement HSTS"})," - Force HTTPS"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Validate certificates"})," - Proper certificate chain"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Use secure cookies"})," - Secure, HttpOnly, SameSite flags"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"-common-mistakes-8",children:"\u274c Common Mistakes"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-javascript",children:"// \u274c Bad - HTTP in production\nconst apiBase = 'http://api.example.com';\n\n// \u2705 Good - HTTPS only\nconst apiBase = 'https://api.example.com';\n\n// \u274c Bad - insecure cookie\ndocument.cookie = `token=${jwt}`;\n\n// \u2705 Good - secure cookie\ndocument.cookie = `token=${jwt}; Secure; HttpOnly; SameSite=Strict`;\n\n// \u274c Bad - ignoring certificate errors\nprocess.env.NODE_TLS_REJECT_UNAUTHORIZED = '0';\n\n// \u2705 Good - validate certificates\n// Use proper certificate chain\n"})}),"\n",(0,n.jsx)(s.h2,{id:"security-testing",children:"Security Testing"}),"\n",(0,n.jsx)(s.h3,{id:"-testing-checklist",children:"\u2705 Testing Checklist"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test authentication flow"})," - Token generation, refresh, expiration"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test authorization"})," - Grant checking, 403 responses"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test tenant isolation"})," - Cross-tenant access attempts"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test context filtering"})," - Peso, ambiente, centro_dett"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test rate limiting"})," - 429 responses, backoff"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test audit trail"})," - Verify CREATED_BY, UPDATED_BY"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test input validation"})," - Invalid data rejection"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Penetration testing"})," - Professional security audit"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test error handling"})," - No sensitive data leaked"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Test HTTPS"})," - Certificate validation"]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"security-test-examples",children:"Security Test Examples"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-javascript",children:"// Test tenant isolation\ntest('cannot access other tenant data', async () => {\n  // Login as tenant A\n  await login('userA@example.com', 'password', 'tenantA', 'admin');\n\n  // Try to access tenant B's product\n  const response = await getProduct(tenantBProductId);\n\n  expect(response.status).toBe(404);  // Not 403!\n});\n\n// Test grant enforcement\ntest('cannot create without grant', async () => {\n  // Login with read-only grant\n  await login('user@example.com', 'password', 'tenantA', 'admin');\n\n  // Try to create product\n  const response = await createProduct({ XPRD01: 'Widget' });\n\n  expect(response.status).toBe(403);\n  expect(response.body.code).toBe('GRANT_DENIED');\n});\n\n// Test rate limiting\ntest('rate limit enforced', async () => {\n  const requests = Array(1001).fill().map(() =>\n    getProducts()\n  );\n\n  const responses = await Promise.all(requests);\n  const rateLimited = responses.filter(r => r.status === 429);\n\n  expect(rateLimited.length).toBeGreaterThan(0);\n});\n"})}),"\n",(0,n.jsx)(s.h2,{id:"deployment-checklist",children:"Deployment Checklist"}),"\n",(0,n.jsx)(s.h3,{id:"-production-readiness",children:"\u2705 Production Readiness"}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Change default secrets"})," - JWT_SECRET, database passwords"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Enable HTTPS"})," - Valid SSL certificates"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Configure CORS"})," - Restrict allowed origins"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Set secure headers"})," - HSTS, CSP, X-Frame-Options"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Enable rate limiting"})," - Appropriate limits configured"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Configure audit logging"})," - Centralized log collection"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Set up monitoring"})," - Security alerts and dashboards"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Document security procedures"})," - Incident response plan"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Regular security updates"})," - Patch dependencies"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ",(0,n.jsx)(s.strong,{children:"Backup audit logs"})," - Immutable audit trail"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Critical Security Requirements:"})}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"\u2705 HTTPS in production"}),"\n",(0,n.jsx)(s.li,{children:"\u2705 Secure token storage (httpOnly cookies)"}),"\n",(0,n.jsx)(s.li,{children:"\u2705 Server-side grant validation"}),"\n",(0,n.jsx)(s.li,{children:"\u2705 Complete tenant isolation (source filtering)"}),"\n",(0,n.jsx)(s.li,{children:"\u2705 Context-based security (peso/ambiente/centro_dett)"}),"\n",(0,n.jsx)(s.li,{children:"\u2705 Rate limiting with backoff"}),"\n",(0,n.jsx)(s.li,{children:"\u2705 Automatic audit trail"}),"\n",(0,n.jsx)(s.li,{children:"\u2705 Input validation"}),"\n",(0,n.jsx)(s.li,{children:"\u2705 Secure error handling"}),"\n",(0,n.jsx)(s.li,{children:"\u2705 Regular security testing"}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Top Security Mistakes to Avoid:"})}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"\u274c Using HTTP in production"}),"\n",(0,n.jsx)(s.li,{children:"\u274c Storing tokens in localStorage"}),"\n",(0,n.jsx)(s.li,{children:"\u274c Client-side only validation/authorization"}),"\n",(0,n.jsx)(s.li,{children:"\u274c Missing tenant context (source)"}),"\n",(0,n.jsx)(s.li,{children:"\u274c Ignoring rate limits"}),"\n",(0,n.jsx)(s.li,{children:"\u274c Force deleting (no audit trail)"}),"\n",(0,n.jsx)(s.li,{children:"\u274c Exposing sensitive data in errors"}),"\n",(0,n.jsx)(s.li,{children:"\u274c No input validation"}),"\n",(0,n.jsx)(s.li,{children:"\u274c Mixing environments (test/production)"}),"\n",(0,n.jsx)(s.li,{children:"\u274c Hardcoded credentials or permissions"}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Security Review Questions:"})}),"\n",(0,n.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Are all API calls over HTTPS?"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Are tokens stored securely?"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Is server-side validation implemented?"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Is tenant isolation verified?"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Are rate limits respected?"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Is audit trail complete?"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Is input sanitized?"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Are errors handled securely?"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Is security testing automated?"]}),"\n",(0,n.jsxs)(s.li,{className:"task-list-item",children:[(0,n.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Are security procedures documented?"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"related-concepts",children:"Related Concepts"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/security/authentication",children:"Authentication"})," - JWT tokens"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/security/authorization",children:"Authorization"})," - TB_MENU grants"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/security/tenant-isolation",children:"Tenant Isolation"})," - Multi-tenancy"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/security/context-security",children:"Context Security"})," - Peso/ambiente/centro_dett"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/security/rate-limiting",children:"Rate Limiting"})," - API throttling"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/security/audit-trail",children:"Audit Trail"})," - Operation tracking"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"/docs/products/map.q01.io/core-api-platform-v4/security",children:"Security Overview"})," - Multi-level security"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.M)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},2172:(e,s,t)=>{t.d(s,{I:()=>l,M:()=>r});var n=t(1504);const i={},a=n.createContext(i);function r(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);