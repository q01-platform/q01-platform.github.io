"use strict";(self.webpackChunkq_01_docs=self.webpackChunkq_01_docs||[]).push([[896],{6164:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>c,toc:()=>h});var i=s(7624),t=s(2172);const d=s.p+"assets/images/auth-flow-d6eae752546ca749f05f035c53fb8bc6.png",r=s.p+"assets/images/auth-bpmn-133e136c8170ec12f03b2fa7ddb7c43d.png",o={id:"map-core-api-authentication",title:"Authentication",sidebar_label:"Authentication"},a="Authentication",c={id:"products/map.q01.io/core-api/authentication/map-core-api-authentication",title:"Authentication",description:"Authentication",source:"@site/docs/products/map.q01.io/core-api/3-authentication/index.md",sourceDirName:"products/map.q01.io/core-api/3-authentication",slug:"/products/map.q01.io/core-api/authentication/",permalink:"/docs/products/map.q01.io/core-api/authentication/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"map-core-api-authentication",title:"Authentication",sidebar_label:"Authentication"},sidebar:"mapSidebar",previous:{title:"Database Access",permalink:"/docs/products/map.q01.io/core-api/database-access/"},next:{title:"Core Components",permalink:"/docs/products/map.q01.io/core-api/core-components/"}},l={},h=[{value:"Auth Flow",id:"auth-flow",level:2},{value:"JWT Token",id:"jwt-token",level:2},{value:"Login",id:"login",level:2},{value:"Method",id:"method",level:5},{value:"Request Headers",id:"request-headers",level:5},{value:"Request Body (raw json)",id:"request-body-raw-json",level:5},{value:"Response",id:"response",level:5},{value:"Logout",id:"logout",level:2},{value:"Method",id:"method-1",level:5},{value:"Request Headers",id:"request-headers-1",level:5},{value:"Response",id:"response-1",level:5},{value:"Token Validation",id:"token-validation",level:2},{value:"Method",id:"method-2",level:5},{value:"Request Headers",id:"request-headers-2",level:5},{value:"Response",id:"response-2",level:5}];function u(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h5:"h5",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsx)(n.p,{children:"To use the core APIs, access credentials to the platform are required. Credentials can be of two types: access tokens or a username/password pair. Additionally, the customer code (related to the environment), the environment code, and the refappId (reference app ID) must be provided, along with optionally a UUID and a user agent."}),"\n",(0,i.jsx)(n.p,{children:'The authentication process generates a JWT token that has a duration of 15 minutes, plus an hour of inactivity during which the token is in a "RENEWABLE" state (it becomes active again upon first use).'}),"\n",(0,i.jsx)(n.h2,{id:"auth-flow",children:"Auth Flow"}),"\n",(0,i.jsx)(n.p,{children:"Below is the diagram representing the flow that returns a valid token to the client."}),"\n",(0,i.jsx)("img",{src:d}),"\n",(0,i.jsx)("img",{src:r}),"\n",(0,i.jsx)(n.p,{children:"The authentication process consists of three phases:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:'Authentication: The provided credentials are verified in the microservice "msauth".'}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Profiling: User information linked to the provided credentials is retrieved, and the grants associated with the user are fetched."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Interface/Database Accessibility: Relevant information for generating interface menus (BOX and MENU) that the logged-in user can see is retrieved."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["All retrieved data is saved in the session table, and the ",(0,i.jsx)(n.code,{children:'"sessionId"'})," is inserted into the generated JWT token."]}),"\n",(0,i.jsx)(n.h2,{id:"jwt-token",children:"JWT Token"}),"\n",(0,i.jsx)(n.p,{children:"An example of the obtained token is as follows"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3dlcjJyZXRhaWwuY29tIiwiYXVkIjoiaHR0cDpcL1wva2V0Y2hhcHAucG93ZXIycmV0YWlsLmNvbSIsImlhdCI6MTU4NTUwNzcyMCwibmJmIjoxNTg1NTA3NzIwLCJleHAiOjE1ODU1MDg2MjAsInNlc3Npb25JZCI6IjI2NiJ9PsXGIFRBCT7QpQycZQU6ZEm259xh8InPECTy-fIxkkmpR3f6Pz_zrLpYZAMwc4mjmWDeF-88Pb9XpLqLZdBxlo-wb0fDP7-LXNiT2cCeeDGkCPeBQaaLzOWSAdrVFdXvvcUYnZcTodPk0lFq2GINlCK-5D1QwOuvTs3nzpyLIYk\n"})}),"\n",(0,i.jsx)(n.p,{children:"The clear content of the token is as follows"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "iss": "q01.io",\n  "aud": "http://q01.io",\n  "iat": 1585507720,\n  "nbf": 1585507720,\n  "exp": 1585508620,\n  "sessionId": "266"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:'"sessionId"'})," field, as described earlier, is the key to access the information (authorization and profiling) related to the owner of the token."]}),"\n",(0,i.jsx)(n.h2,{id:"login",children:"Login"}),"\n",(0,i.jsx)(n.p,{children:"The login endpoint is used to authenticate a user and obtain an authentication token."}),"\n",(0,i.jsx)(n.h5,{id:"method",children:"Method"}),"\n",(0,i.jsx)(n.p,{children:"POST /api/v4/auth/login"}),"\n",(0,i.jsx)(n.h5,{id:"request-headers",children:"Request Headers"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"key"}),(0,i.jsx)(n.th,{children:"value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"content-type"}),(0,i.jsx)(n.td,{children:"application/json"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"accept"}),(0,i.jsx)(n.td,{children:"application/json"})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"request-body-raw-json",children:"Request Body (raw json)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "username": "{{username}}",\n    "password": "{{password}}",\n    "resource": "{{resource}}",\n    "tenantId": "{{idTenant}}",\n    "uuid": "unique-device-id"\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"username"})," (string, required): The username of the user."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"password"})," (string, required): The password of the user."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"resource"})," (string, required): The resource being accessed."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tenantId"})," (string, required): The ID of the tenant."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"uuid"})," (string, required): The UUID of the user."]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["it's possible to use key ",(0,i.jsx)(n.code,{children:"access_token"})," instead of ",(0,i.jsx)(n.code,{children:"username"})," and ",(0,i.jsx)(n.code,{children:"password"})]})}),"\n",(0,i.jsx)(n.h5,{id:"response",children:"Response"}),"\n",(0,i.jsx)(n.p,{children:"Upon a successful authentication, the endpoint returns a JSON object with the following fields:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"idToken"})," (string): The authentication token."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"issuedAt"})," (integer): The timestamp when the token was issued."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"durationTime"})," (string): The duration of the token validity."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"expiresIn"})," (integer): The expiration time of the token."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Here is an example of a Success response 200"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "idToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJxMDEuaW8iLCJhdWQiOiJxMDEuaW8iLCJpYXQiOjE3MTA1MTU5NTgsIm5iZiI6MTcxMDUxNTk1OCwiZXhwIjoxNzEwNTE2NTU4LCJzZXNzaW9uSWQiOjEyfQ.Zv2e62baUs9OrnrO7fPVPPAxpuRhpnD3jWiKYOCmouJgSfwcH-d5ooFgbDeEfXilI2KFkqzZA9iV-x8iXYr2_q_x2JZtVc76T07c1z33mL-VxezzZvCj1DxKmrWMDUDnp_kcUa7oCFOiERMp5k7d4ywWW1Puzg-fwubx6M3XJQE",\n    "issuedAt": 1710515958,\n    "durationTime": "600",\n    "expiresIn": 1710516558\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"and an Unauthorized response 401"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "status": 0,\n    "message": "",\n    "data": [],\n    "errors": []\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"logout",children:"Logout"}),"\n",(0,i.jsx)(n.p,{children:"The logout endpoint is used to invalidate a session."}),"\n",(0,i.jsx)(n.h5,{id:"method-1",children:"Method"}),"\n",(0,i.jsx)(n.p,{children:"GET /api/v4/auth/logout"}),"\n",(0,i.jsx)(n.h5,{id:"request-headers-1",children:"Request Headers"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"key"}),(0,i.jsx)(n.th,{children:"value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"content-type"}),(0,i.jsx)(n.td,{children:"application/json"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"accept"}),(0,i.jsx)(n.td,{children:"application/json"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"microservice"}),(0,i.jsx)(n.td,{children:"msauth"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"authorization"}),(0,i.jsxs)(n.td,{children:["bearer ",(0,i.jsx)(n.em,{children:"tokenId"})]})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"response-1",children:"Response"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"status_code"})," (number): The status code of the response."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"message"})," (string, optional): A message related to the logout status."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"An example of a Success response 200"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "status_code": 200,\n    "message": ""\n}\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"token-validation",children:"Token Validation"}),"\n",(0,i.jsx)(n.p,{children:"The token validation endpoint is used to validate an authentication token via an HTTP GET request"}),"\n",(0,i.jsx)(n.h5,{id:"method-2",children:"Method"}),"\n",(0,i.jsx)(n.p,{children:"GET /api/v4/auth/tokenvalidator"}),"\n",(0,i.jsx)(n.h5,{id:"request-headers-2",children:"Request Headers"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"key"}),(0,i.jsx)(n.th,{children:"value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"content-type"}),(0,i.jsx)(n.td,{children:"application/json"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"accept"}),(0,i.jsx)(n.td,{children:"application/json"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"microservice"}),(0,i.jsx)(n.td,{children:"msauth"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"authorization"}),(0,i.jsxs)(n.td,{children:["bearer ",(0,i.jsx)(n.em,{children:"tokenId"})]})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"response-2",children:"Response"}),"\n",(0,i.jsx)(n.p,{children:"Upon a successful execution, the endpoint returns a JSON response with a status code of 200 and a content type of application/json. The response body includes the following key-value pairs:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"code"}),": An integer representing the status code of the validation process."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"message"}),": A string providing additional information or error message related to the token validation."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example of valid session"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "code": 200,\n    "message": "Token is Valid"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Example of an invalid session"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "code": 401,\n    "msg": "Invalid Auth Token provided. Can\'t access to the resource!",\n    "status": 401,\n    "message": "Invalid Auth Token provided. Can\'t access to the resource!"\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,t.M)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},2172:(e,n,s)=>{s.d(n,{I:()=>o,M:()=>r});var i=s(1504);const t={},d=i.createContext(t);function r(e){const n=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(d.Provider,{value:n},e.children)}}}]);